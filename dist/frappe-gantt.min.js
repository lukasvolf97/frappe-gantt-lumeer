var Gantt = function () { "use strict"; "undefined" != typeof globalThis ? globalThis : "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self && self; function t() { throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs") } var e, s = (function (e, s) { e.exports = function () { var s, i; function n() { return s.apply(null, arguments) } function a(t) { return t instanceof Array || "[object Array]" === Object.prototype.toString.call(t) } function r(t) { return null != t && "[object Object]" === Object.prototype.toString.call(t) } function o(t) { return void 0 === t } function h(t) { return "number" == typeof t || "[object Number]" === Object.prototype.toString.call(t) } function d(t) { return t instanceof Date || "[object Date]" === Object.prototype.toString.call(t) } function l(t, e) { var s, i = []; for (s = 0; s < t.length; ++s)i.push(e(t[s], s)); return i } function u(t, e) { return Object.prototype.hasOwnProperty.call(t, e) } function _(t, e) { for (var s in e) u(e, s) && (t[s] = e[s]); return u(e, "toString") && (t.toString = e.toString), u(e, "valueOf") && (t.valueOf = e.valueOf), t } function c(t, e, s, i) { return Oe(t, e, s, i, !0).utc() } function p(t) { return null == t._pf && (t._pf = { empty: !1, unusedTokens: [], unusedInput: [], overflow: -2, charsLeftOver: 0, nullInput: !1, invalidMonth: null, invalidFormat: !1, userInvalidated: !1, iso: !1, parsedDateParts: [], meridiem: null, rfc2822: !1, weekdayMismatch: !1 }), t._pf } function g(t) { if (null == t._isValid) { var e = p(t), s = i.call(e.parsedDateParts, function (t) { return null != t }), n = !isNaN(t._d.getTime()) && e.overflow < 0 && !e.empty && !e.invalidMonth && !e.invalidWeekday && !e.weekdayMismatch && !e.nullInput && !e.invalidFormat && !e.userInvalidated && (!e.meridiem || e.meridiem && s); if (t._strict && (n = n && 0 === e.charsLeftOver && 0 === e.unusedTokens.length && void 0 === e.bigHour), null != Object.isFrozen && Object.isFrozen(t)) return n; t._isValid = n } return t._isValid } function f(t) { var e = c(NaN); return null != t ? _(p(e), t) : p(e).userInvalidated = !0, e } i = Array.prototype.some ? Array.prototype.some : function (t) { for (var e = Object(this), s = e.length >>> 0, i = 0; i < s; i++)if (i in e && t.call(this, e[i], i, e)) return !0; return !1 }; var m = n.momentProperties = []; function w(t, e) { var s, i, n; if (o(e._isAMomentObject) || (t._isAMomentObject = e._isAMomentObject), o(e._i) || (t._i = e._i), o(e._f) || (t._f = e._f), o(e._l) || (t._l = e._l), o(e._strict) || (t._strict = e._strict), o(e._tzm) || (t._tzm = e._tzm), o(e._isUTC) || (t._isUTC = e._isUTC), o(e._offset) || (t._offset = e._offset), o(e._pf) || (t._pf = p(e)), o(e._locale) || (t._locale = e._locale), m.length > 0) for (s = 0; s < m.length; s++)i = m[s], o(n = e[i]) || (t[i] = n); return t } var y = !1; function v(t) { w(this, t), this._d = new Date(null != t._d ? t._d.getTime() : NaN), this.isValid() || (this._d = new Date(NaN)), !1 === y && (y = !0, n.updateOffset(this), y = !1) } function k(t) { return t instanceof v || null != t && null != t._isAMomentObject } function b(t) { return t < 0 ? Math.ceil(t) || 0 : Math.floor(t) } function M(t) { var e = +t, s = 0; return 0 !== e && isFinite(e) && (s = b(e)), s } function D(t, e, s) { var i, n = Math.min(t.length, e.length), a = Math.abs(t.length - e.length), r = 0; for (i = 0; i < n; i++)(s && t[i] !== e[i] || !s && M(t[i]) !== M(e[i])) && r++; return r + a } function S(t) { !1 === n.suppressDeprecationWarnings && "undefined" != typeof console && console.warn && console.warn("Deprecation warning: " + t) } function Y(t, e) { var s = !0; return _(function () { if (null != n.deprecationHandler && n.deprecationHandler(null, t), s) { for (var i, a = [], r = 0; r < arguments.length; r++) { if (i = "", "object" == typeof arguments[r]) { for (var o in i += "\n[" + r + "] ", arguments[0]) i += o + ": " + arguments[0][o] + ", "; i = i.slice(0, -2) } else i = arguments[r]; a.push(i) } S(t + "\nArguments: " + Array.prototype.slice.call(a).join("") + "\n" + (new Error).stack), s = !1 } return e.apply(this, arguments) }, e) } var x, $ = {}; function T(t, e) { null != n.deprecationHandler && n.deprecationHandler(t, e), $[t] || (S(e), $[t] = !0) } function O(t) { return t instanceof Function || "[object Function]" === Object.prototype.toString.call(t) } function H(t, e) { var s, i = _({}, t); for (s in e) u(e, s) && (r(t[s]) && r(e[s]) ? (i[s] = {}, _(i[s], t[s]), _(i[s], e[s])) : null != e[s] ? i[s] = e[s] : delete i[s]); for (s in t) u(t, s) && !u(e, s) && r(t[s]) && (i[s] = _({}, i[s])); return i } function W(t) { null != t && this.set(t) } n.suppressDeprecationWarnings = !1, n.deprecationHandler = null, x = Object.keys ? Object.keys : function (t) { var e, s = []; for (e in t) u(t, e) && s.push(e); return s }; var L = {}; function C(t, e) { var s = t.toLowerCase(); L[s] = L[s + "s"] = L[e] = t } function E(t) { return "string" == typeof t ? L[t] || L[t.toLowerCase()] : void 0 } function P(t) { var e, s, i = {}; for (s in t) u(t, s) && (e = E(s)) && (i[e] = t[s]); return i } var A = {}; function F(t, e) { A[t] = e } function R(t, e, s) { var i = "" + Math.abs(t), n = e - i.length, a = t >= 0; return (a ? s ? "+" : "" : "-") + Math.pow(10, Math.max(0, n)).toString().substr(1) + i } var N = /(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g, U = /(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g, G = {}, V = {}; function I(t, e, s, i) { var n = i; "string" == typeof i && (n = function () { return this[i]() }), t && (V[t] = n), e && (V[e[0]] = function () { return R(n.apply(this, arguments), e[1], e[2]) }), s && (V[s] = function () { return this.localeData().ordinal(n.apply(this, arguments), t) }) } function j(t, e) { return t.isValid() ? (e = z(e, t.localeData()), G[e] = G[e] || function (t) { var e, s, i, n = t.match(N); for (e = 0, s = n.length; e < s; e++)V[n[e]] ? n[e] = V[n[e]] : n[e] = (i = n[e]).match(/\[[\s\S]/) ? i.replace(/^\[|\]$/g, "") : i.replace(/\\/g, ""); return function (e) { var i, a = ""; for (i = 0; i < s; i++)a += O(n[i]) ? n[i].call(e, t) : n[i]; return a } }(e), G[e](t)) : t.localeData().invalidDate() } function z(t, e) { var s = 5; function i(t) { return e.longDateFormat(t) || t } for (U.lastIndex = 0; s >= 0 && U.test(t);)t = t.replace(U, i), U.lastIndex = 0, s -= 1; return t } var Z = /\d/, X = /\d\d/, q = /\d{3}/, B = /\d{4}/, J = /[+-]?\d{6}/, Q = /\d\d?/, K = /\d\d\d\d?/, tt = /\d\d\d\d\d\d?/, et = /\d{1,3}/, st = /\d{1,4}/, it = /[+-]?\d{1,6}/, nt = /\d+/, at = /[+-]?\d+/, rt = /Z|[+-]\d\d:?\d\d/gi, ot = /Z|[+-]\d\d(?::?\d\d)?/gi, ht = /[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i, dt = {}; function lt(t, e, s) { dt[t] = O(e) ? e : function (t, i) { return t && s ? s : e } } function ut(t, e) { return u(dt, t) ? dt[t](e._strict, e._locale) : new RegExp(_t(t.replace("\\", "").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g, function (t, e, s, i, n) { return e || s || i || n }))) } function _t(t) { return t.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&") } var ct = {}; function pt(t, e) { var s, i = e; for ("string" == typeof t && (t = [t]), h(e) && (i = function (t, s) { s[e] = M(t) }), s = 0; s < t.length; s++)ct[t[s]] = i } function gt(t, e) { pt(t, function (t, s, i, n) { i._w = i._w || {}, e(t, i._w, i, n) }) } function ft(t, e, s) { null != e && u(ct, t) && ct[t](e, s._a, s, t) } var mt = 0, wt = 1, yt = 2, vt = 3, kt = 4, bt = 5, Mt = 6, Dt = 7, St = 8; function Yt(t) { return xt(t) ? 366 : 365 } function xt(t) { return t % 4 == 0 && t % 100 != 0 || t % 400 == 0 } I("Y", 0, 0, function () { var t = this.year(); return t <= 9999 ? "" + t : "+" + t }), I(0, ["YY", 2], 0, function () { return this.year() % 100 }), I(0, ["YYYY", 4], 0, "year"), I(0, ["YYYYY", 5], 0, "year"), I(0, ["YYYYYY", 6, !0], 0, "year"), C("year", "y"), F("year", 1), lt("Y", at), lt("YY", Q, X), lt("YYYY", st, B), lt("YYYYY", it, J), lt("YYYYYY", it, J), pt(["YYYYY", "YYYYYY"], mt), pt("YYYY", function (t, e) { e[mt] = 2 === t.length ? n.parseTwoDigitYear(t) : M(t) }), pt("YY", function (t, e) { e[mt] = n.parseTwoDigitYear(t) }), pt("Y", function (t, e) { e[mt] = parseInt(t, 10) }), n.parseTwoDigitYear = function (t) { return M(t) + (M(t) > 68 ? 1900 : 2e3) }; var $t, Tt = Ot("FullYear", !0); function Ot(t, e) { return function (s) { return null != s ? (Wt(this, t, s), n.updateOffset(this, e), this) : Ht(this, t) } } function Ht(t, e) { return t.isValid() ? t._d["get" + (t._isUTC ? "UTC" : "") + e]() : NaN } function Wt(t, e, s) { t.isValid() && !isNaN(s) && ("FullYear" === e && xt(t.year()) && 1 === t.month() && 29 === t.date() ? t._d["set" + (t._isUTC ? "UTC" : "") + e](s, t.month(), Lt(s, t.month())) : t._d["set" + (t._isUTC ? "UTC" : "") + e](s)) } function Lt(t, e) { if (isNaN(t) || isNaN(e)) return NaN; var s, i = (e % (s = 12) + s) % s; return t += (e - i) / 12, 1 === i ? xt(t) ? 29 : 28 : 31 - i % 7 % 2 } $t = Array.prototype.indexOf ? Array.prototype.indexOf : function (t) { var e; for (e = 0; e < this.length; ++e)if (this[e] === t) return e; return -1 }, I("M", ["MM", 2], "Mo", function () { return this.month() + 1 }), I("MMM", 0, 0, function (t) { return this.localeData().monthsShort(this, t) }), I("MMMM", 0, 0, function (t) { return this.localeData().months(this, t) }), C("month", "M"), F("month", 8), lt("M", Q), lt("MM", Q, X), lt("MMM", function (t, e) { return e.monthsShortRegex(t) }), lt("MMMM", function (t, e) { return e.monthsRegex(t) }), pt(["M", "MM"], function (t, e) { e[wt] = M(t) - 1 }), pt(["MMM", "MMMM"], function (t, e, s, i) { var n = s._locale.monthsParse(t, i, s._strict); null != n ? e[wt] = n : p(s).invalidMonth = t }); var Ct = /D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/, Et = "January_February_March_April_May_June_July_August_September_October_November_December".split("_"), Pt = "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"); function At(t, e) { var s; if (!t.isValid()) return t; if ("string" == typeof e) if (/^\d+$/.test(e)) e = M(e); else if (!h(e = t.localeData().monthsParse(e))) return t; return s = Math.min(t.date(), Lt(t.year(), e)), t._d["set" + (t._isUTC ? "UTC" : "") + "Month"](e, s), t } function Ft(t) { return null != t ? (At(this, t), n.updateOffset(this, !0), this) : Ht(this, "Month") } var Rt = ht, Nt = ht; function Ut() { function t(t, e) { return e.length - t.length } var e, s, i = [], n = [], a = []; for (e = 0; e < 12; e++)s = c([2e3, e]), i.push(this.monthsShort(s, "")), n.push(this.months(s, "")), a.push(this.months(s, "")), a.push(this.monthsShort(s, "")); for (i.sort(t), n.sort(t), a.sort(t), e = 0; e < 12; e++)i[e] = _t(i[e]), n[e] = _t(n[e]); for (e = 0; e < 24; e++)a[e] = _t(a[e]); this._monthsRegex = new RegExp("^(" + a.join("|") + ")", "i"), this._monthsShortRegex = this._monthsRegex, this._monthsStrictRegex = new RegExp("^(" + n.join("|") + ")", "i"), this._monthsShortStrictRegex = new RegExp("^(" + i.join("|") + ")", "i") } function Gt(t) { var e; if (t < 100 && t >= 0) { var s = Array.prototype.slice.call(arguments); s[0] = t + 400, e = new Date(Date.UTC.apply(null, s)), isFinite(e.getUTCFullYear()) && e.setUTCFullYear(t) } else e = new Date(Date.UTC.apply(null, arguments)); return e } function Vt(t, e, s) { var i = 7 + e - s, n = (7 + Gt(t, 0, i).getUTCDay() - e) % 7; return -n + i - 1 } function It(t, e, s, i, n) { var a, r, o = (7 + s - i) % 7, h = Vt(t, i, n), d = 1 + 7 * (e - 1) + o + h; return d <= 0 ? r = Yt(a = t - 1) + d : d > Yt(t) ? (a = t + 1, r = d - Yt(t)) : (a = t, r = d), { year: a, dayOfYear: r } } function jt(t, e, s) { var i, n, a = Vt(t.year(), e, s), r = Math.floor((t.dayOfYear() - a - 1) / 7) + 1; return r < 1 ? (n = t.year() - 1, i = r + zt(n, e, s)) : r > zt(t.year(), e, s) ? (i = r - zt(t.year(), e, s), n = t.year() + 1) : (n = t.year(), i = r), { week: i, year: n } } function zt(t, e, s) { var i = Vt(t, e, s), n = Vt(t + 1, e, s); return (Yt(t) - i + n) / 7 } function Zt(t, e) { return t.slice(e, 7).concat(t.slice(0, e)) } I("w", ["ww", 2], "wo", "week"), I("W", ["WW", 2], "Wo", "isoWeek"), C("week", "w"), C("isoWeek", "W"), F("week", 5), F("isoWeek", 5), lt("w", Q), lt("ww", Q, X), lt("W", Q), lt("WW", Q, X), gt(["w", "ww", "W", "WW"], function (t, e, s, i) { e[i.substr(0, 1)] = M(t) }), I("d", 0, "do", "day"), I("dd", 0, 0, function (t) { return this.localeData().weekdaysMin(this, t) }), I("ddd", 0, 0, function (t) { return this.localeData().weekdaysShort(this, t) }), I("dddd", 0, 0, function (t) { return this.localeData().weekdays(this, t) }), I("e", 0, 0, "weekday"), I("E", 0, 0, "isoWeekday"), C("day", "d"), C("weekday", "e"), C("isoWeekday", "E"), F("day", 11), F("weekday", 11), F("isoWeekday", 11), lt("d", Q), lt("e", Q), lt("E", Q), lt("dd", function (t, e) { return e.weekdaysMinRegex(t) }), lt("ddd", function (t, e) { return e.weekdaysShortRegex(t) }), lt("dddd", function (t, e) { return e.weekdaysRegex(t) }), gt(["dd", "ddd", "dddd"], function (t, e, s, i) { var n = s._locale.weekdaysParse(t, i, s._strict); null != n ? e.d = n : p(s).invalidWeekday = t }), gt(["d", "e", "E"], function (t, e, s, i) { e[i] = M(t) }); var Xt = "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"), qt = "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"), Bt = "Su_Mo_Tu_We_Th_Fr_Sa".split("_"), Jt = ht, Qt = ht, Kt = ht; function te() { function t(t, e) { return e.length - t.length } var e, s, i, n, a, r = [], o = [], h = [], d = []; for (e = 0; e < 7; e++)s = c([2e3, 1]).day(e), i = this.weekdaysMin(s, ""), n = this.weekdaysShort(s, ""), a = this.weekdays(s, ""), r.push(i), o.push(n), h.push(a), d.push(i), d.push(n), d.push(a); for (r.sort(t), o.sort(t), h.sort(t), d.sort(t), e = 0; e < 7; e++)o[e] = _t(o[e]), h[e] = _t(h[e]), d[e] = _t(d[e]); this._weekdaysRegex = new RegExp("^(" + d.join("|") + ")", "i"), this._weekdaysShortRegex = this._weekdaysRegex, this._weekdaysMinRegex = this._weekdaysRegex, this._weekdaysStrictRegex = new RegExp("^(" + h.join("|") + ")", "i"), this._weekdaysShortStrictRegex = new RegExp("^(" + o.join("|") + ")", "i"), this._weekdaysMinStrictRegex = new RegExp("^(" + r.join("|") + ")", "i") } function ee() { return this.hours() % 12 || 12 } function se(t, e) { I(t, 0, 0, function () { return this.localeData().meridiem(this.hours(), this.minutes(), e) }) } function ie(t, e) { return e._meridiemParse } I("H", ["HH", 2], 0, "hour"), I("h", ["hh", 2], 0, ee), I("k", ["kk", 2], 0, function () { return this.hours() || 24 }), I("hmm", 0, 0, function () { return "" + ee.apply(this) + R(this.minutes(), 2) }), I("hmmss", 0, 0, function () { return "" + ee.apply(this) + R(this.minutes(), 2) + R(this.seconds(), 2) }), I("Hmm", 0, 0, function () { return "" + this.hours() + R(this.minutes(), 2) }), I("Hmmss", 0, 0, function () { return "" + this.hours() + R(this.minutes(), 2) + R(this.seconds(), 2) }), se("a", !0), se("A", !1), C("hour", "h"), F("hour", 13), lt("a", ie), lt("A", ie), lt("H", Q), lt("h", Q), lt("k", Q), lt("HH", Q, X), lt("hh", Q, X), lt("kk", Q, X), lt("hmm", K), lt("hmmss", tt), lt("Hmm", K), lt("Hmmss", tt), pt(["H", "HH"], vt), pt(["k", "kk"], function (t, e, s) { var i = M(t); e[vt] = 24 === i ? 0 : i }), pt(["a", "A"], function (t, e, s) { s._isPm = s._locale.isPM(t), s._meridiem = t }), pt(["h", "hh"], function (t, e, s) { e[vt] = M(t), p(s).bigHour = !0 }), pt("hmm", function (t, e, s) { var i = t.length - 2; e[vt] = M(t.substr(0, i)), e[kt] = M(t.substr(i)), p(s).bigHour = !0 }), pt("hmmss", function (t, e, s) { var i = t.length - 4, n = t.length - 2; e[vt] = M(t.substr(0, i)), e[kt] = M(t.substr(i, 2)), e[bt] = M(t.substr(n)), p(s).bigHour = !0 }), pt("Hmm", function (t, e, s) { var i = t.length - 2; e[vt] = M(t.substr(0, i)), e[kt] = M(t.substr(i)) }), pt("Hmmss", function (t, e, s) { var i = t.length - 4, n = t.length - 2; e[vt] = M(t.substr(0, i)), e[kt] = M(t.substr(i, 2)), e[bt] = M(t.substr(n)) }); var ne, ae = Ot("Hours", !0), re = { calendar: { sameDay: "[Today at] LT", nextDay: "[Tomorrow at] LT", nextWeek: "dddd [at] LT", lastDay: "[Yesterday at] LT", lastWeek: "[Last] dddd [at] LT", sameElse: "L" }, longDateFormat: { LTS: "h:mm:ss A", LT: "h:mm A", L: "MM/DD/YYYY", LL: "MMMM D, YYYY", LLL: "MMMM D, YYYY h:mm A", LLLL: "dddd, MMMM D, YYYY h:mm A" }, invalidDate: "Invalid date", ordinal: "%d", dayOfMonthOrdinalParse: /\d{1,2}/, relativeTime: { future: "in %s", past: "%s ago", s: "a few seconds", ss: "%d seconds", m: "a minute", mm: "%d minutes", h: "an hour", hh: "%d hours", d: "a day", dd: "%d days", M: "a month", MM: "%d months", y: "a year", yy: "%d years" }, months: Et, monthsShort: Pt, week: { dow: 0, doy: 6 }, weekdays: Xt, weekdaysMin: Bt, weekdaysShort: qt, meridiemParse: /[ap]\.?m?\.?/i }, oe = {}, he = {}; function de(t) { return t ? t.toLowerCase().replace("_", "-") : t } function le(s) { var i = null; if (!oe[s] && e && e.exports) try { i = ne._abbr; var n = t; n("./locale/" + s), ue(i) } catch (t) { } return oe[s] } function ue(t, e) { var s; return t && ((s = o(e) ? ce(t) : _e(t, e)) ? ne = s : "undefined" != typeof console && console.warn && console.warn("Locale " + t + " not found. Did you forget to load it?")), ne._abbr } function _e(t, e) { if (null !== e) { var s, i = re; if (e.abbr = t, null != oe[t]) T("defineLocaleOverride", "use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."), i = oe[t]._config; else if (null != e.parentLocale) if (null != oe[e.parentLocale]) i = oe[e.parentLocale]._config; else { if (null == (s = le(e.parentLocale))) return he[e.parentLocale] || (he[e.parentLocale] = []), he[e.parentLocale].push({ name: t, config: e }), null; i = s._config } return oe[t] = new W(H(i, e)), he[t] && he[t].forEach(function (t) { _e(t.name, t.config) }), ue(t), oe[t] } return delete oe[t], null } function ce(t) { var e; if (t && t._locale && t._locale._abbr && (t = t._locale._abbr), !t) return ne; if (!a(t)) { if (e = le(t)) return e; t = [t] } return function (t) { for (var e, s, i, n, a = 0; a < t.length;) { for (n = de(t[a]).split("-"), e = n.length, s = (s = de(t[a + 1])) ? s.split("-") : null; e > 0;) { if (i = le(n.slice(0, e).join("-"))) return i; if (s && s.length >= e && D(n, s, !0) >= e - 1) break; e-- } a++ } return ne }(t) } function pe(t) { var e, s = t._a; return s && -2 === p(t).overflow && (e = s[wt] < 0 || s[wt] > 11 ? wt : s[yt] < 1 || s[yt] > Lt(s[mt], s[wt]) ? yt : s[vt] < 0 || s[vt] > 24 || 24 === s[vt] && (0 !== s[kt] || 0 !== s[bt] || 0 !== s[Mt]) ? vt : s[kt] < 0 || s[kt] > 59 ? kt : s[bt] < 0 || s[bt] > 59 ? bt : s[Mt] < 0 || s[Mt] > 999 ? Mt : -1, p(t)._overflowDayOfYear && (e < mt || e > yt) && (e = yt), p(t)._overflowWeeks && -1 === e && (e = Dt), p(t)._overflowWeekday && -1 === e && (e = St), p(t).overflow = e), t } function ge(t, e, s) { return null != t ? t : null != e ? e : s } function fe(t) { var e, s, i, a, r, o = []; if (!t._d) { for (i = function (t) { var e = new Date(n.now()); return t._useUTC ? [e.getUTCFullYear(), e.getUTCMonth(), e.getUTCDate()] : [e.getFullYear(), e.getMonth(), e.getDate()] }(t), t._w && null == t._a[yt] && null == t._a[wt] && function (t) { var e, s, i, n, a, r, o, h; if (null != (e = t._w).GG || null != e.W || null != e.E) a = 1, r = 4, s = ge(e.GG, t._a[mt], jt(He(), 1, 4).year), i = ge(e.W, 1), ((n = ge(e.E, 1)) < 1 || n > 7) && (h = !0); else { a = t._locale._week.dow, r = t._locale._week.doy; var d = jt(He(), a, r); s = ge(e.gg, t._a[mt], d.year), i = ge(e.w, d.week), null != e.d ? ((n = e.d) < 0 || n > 6) && (h = !0) : null != e.e ? (n = e.e + a, (e.e < 0 || e.e > 6) && (h = !0)) : n = a } i < 1 || i > zt(s, a, r) ? p(t)._overflowWeeks = !0 : null != h ? p(t)._overflowWeekday = !0 : (o = It(s, i, n, a, r), t._a[mt] = o.year, t._dayOfYear = o.dayOfYear) }(t), null != t._dayOfYear && (r = ge(t._a[mt], i[mt]), (t._dayOfYear > Yt(r) || 0 === t._dayOfYear) && (p(t)._overflowDayOfYear = !0), s = Gt(r, 0, t._dayOfYear), t._a[wt] = s.getUTCMonth(), t._a[yt] = s.getUTCDate()), e = 0; e < 3 && null == t._a[e]; ++e)t._a[e] = o[e] = i[e]; for (; e < 7; e++)t._a[e] = o[e] = null == t._a[e] ? 2 === e ? 1 : 0 : t._a[e]; 24 === t._a[vt] && 0 === t._a[kt] && 0 === t._a[bt] && 0 === t._a[Mt] && (t._nextDay = !0, t._a[vt] = 0), t._d = (t._useUTC ? Gt : function (t, e, s, i, n, a, r) { var o; return t < 100 && t >= 0 ? (o = new Date(t + 400, e, s, i, n, a, r), isFinite(o.getFullYear()) && o.setFullYear(t)) : o = new Date(t, e, s, i, n, a, r), o }).apply(null, o), a = t._useUTC ? t._d.getUTCDay() : t._d.getDay(), null != t._tzm && t._d.setUTCMinutes(t._d.getUTCMinutes() - t._tzm), t._nextDay && (t._a[vt] = 24), t._w && void 0 !== t._w.d && t._w.d !== a && (p(t).weekdayMismatch = !0) } } var me = /^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/, we = /^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/, ye = /Z|[+-]\d\d(?::?\d\d)?/, ve = [["YYYYYY-MM-DD", /[+-]\d{6}-\d\d-\d\d/], ["YYYY-MM-DD", /\d{4}-\d\d-\d\d/], ["GGGG-[W]WW-E", /\d{4}-W\d\d-\d/], ["GGGG-[W]WW", /\d{4}-W\d\d/, !1], ["YYYY-DDD", /\d{4}-\d{3}/], ["YYYY-MM", /\d{4}-\d\d/, !1], ["YYYYYYMMDD", /[+-]\d{10}/], ["YYYYMMDD", /\d{8}/], ["GGGG[W]WWE", /\d{4}W\d{3}/], ["GGGG[W]WW", /\d{4}W\d{2}/, !1], ["YYYYDDD", /\d{7}/]], ke = [["HH:mm:ss.SSSS", /\d\d:\d\d:\d\d\.\d+/], ["HH:mm:ss,SSSS", /\d\d:\d\d:\d\d,\d+/], ["HH:mm:ss", /\d\d:\d\d:\d\d/], ["HH:mm", /\d\d:\d\d/], ["HHmmss.SSSS", /\d\d\d\d\d\d\.\d+/], ["HHmmss,SSSS", /\d\d\d\d\d\d,\d+/], ["HHmmss", /\d\d\d\d\d\d/], ["HHmm", /\d\d\d\d/], ["HH", /\d\d/]], be = /^\/?Date\((\-?\d+)/i; function Me(t) { var e, s, i, n, a, r, o = t._i, h = me.exec(o) || we.exec(o); if (h) { for (p(t).iso = !0, e = 0, s = ve.length; e < s; e++)if (ve[e][1].exec(h[1])) { n = ve[e][0], i = !1 !== ve[e][2]; break } if (null == n) return void (t._isValid = !1); if (h[3]) { for (e = 0, s = ke.length; e < s; e++)if (ke[e][1].exec(h[3])) { a = (h[2] || " ") + ke[e][0]; break } if (null == a) return void (t._isValid = !1) } if (!i && null != a) return void (t._isValid = !1); if (h[4]) { if (!ye.exec(h[4])) return void (t._isValid = !1); r = "Z" } t._f = n + (a || "") + (r || ""), $e(t) } else t._isValid = !1 } var De = /^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/; function Se(t, e, s, i, n, a) { var r = [function (t) { var e = parseInt(t, 10); return e <= 49 ? 2e3 + e : e <= 999 ? 1900 + e : e }(t), Pt.indexOf(e), parseInt(s, 10), parseInt(i, 10), parseInt(n, 10)]; return a && r.push(parseInt(a, 10)), r } var Ye = { UT: 0, GMT: 0, EDT: -240, EST: -300, CDT: -300, CST: -360, MDT: -360, MST: -420, PDT: -420, PST: -480 }; function xe(t) { var e = De.exec(t._i.replace(/\([^)]*\)|[\n\t]/g, " ").replace(/(\s\s+)/g, " ").replace(/^\s\s*/, "").replace(/\s\s*$/, "")); if (e) { var s = Se(e[4], e[3], e[2], e[5], e[6], e[7]); if (!function (t, e, s) { if (t) { var i = qt.indexOf(t), n = new Date(e[0], e[1], e[2]).getDay(); if (i !== n) return p(s).weekdayMismatch = !0, s._isValid = !1, !1 } return !0 }(e[1], s, t)) return; t._a = s, t._tzm = function (t, e, s) { if (t) return Ye[t]; if (e) return 0; var i = parseInt(s, 10), n = i % 100, a = (i - n) / 100; return 60 * a + n }(e[8], e[9], e[10]), t._d = Gt.apply(null, t._a), t._d.setUTCMinutes(t._d.getUTCMinutes() - t._tzm), p(t).rfc2822 = !0 } else t._isValid = !1 } function $e(t) { if (t._f !== n.ISO_8601) if (t._f !== n.RFC_2822) { t._a = [], p(t).empty = !0; var e, s, i, a, r, o = "" + t._i, h = o.length, d = 0; for (i = z(t._f, t._locale).match(N) || [], e = 0; e < i.length; e++)a = i[e], (s = (o.match(ut(a, t)) || [])[0]) && ((r = o.substr(0, o.indexOf(s))).length > 0 && p(t).unusedInput.push(r), o = o.slice(o.indexOf(s) + s.length), d += s.length), V[a] ? (s ? p(t).empty = !1 : p(t).unusedTokens.push(a), ft(a, s, t)) : t._strict && !s && p(t).unusedTokens.push(a); p(t).charsLeftOver = h - d, o.length > 0 && p(t).unusedInput.push(o), t._a[vt] <= 12 && !0 === p(t).bigHour && t._a[vt] > 0 && (p(t).bigHour = void 0), p(t).parsedDateParts = t._a.slice(0), p(t).meridiem = t._meridiem, t._a[vt] = (l = t._locale, u = t._a[vt], null == (_ = t._meridiem) ? u : null != l.meridiemHour ? l.meridiemHour(u, _) : null != l.isPM ? ((c = l.isPM(_)) && u < 12 && (u += 12), c || 12 !== u || (u = 0), u) : u), fe(t), pe(t) } else xe(t); else Me(t); var l, u, _, c } function Te(t) { var e = t._i, s = t._f; return t._locale = t._locale || ce(t._l), null === e || void 0 === s && "" === e ? f({ nullInput: !0 }) : ("string" == typeof e && (t._i = e = t._locale.preparse(e)), k(e) ? new v(pe(e)) : (d(e) ? t._d = e : a(s) ? function (t) { var e, s, i, n, a; if (0 === t._f.length) return p(t).invalidFormat = !0, void (t._d = new Date(NaN)); for (n = 0; n < t._f.length; n++)a = 0, e = w({}, t), null != t._useUTC && (e._useUTC = t._useUTC), e._f = t._f[n], $e(e), g(e) && (a += p(e).charsLeftOver, a += 10 * p(e).unusedTokens.length, p(e).score = a, (null == i || a < i) && (i = a, s = e)); _(t, s || e) }(t) : s ? $e(t) : function (t) { var e = t._i; o(e) ? t._d = new Date(n.now()) : d(e) ? t._d = new Date(e.valueOf()) : "string" == typeof e ? function (t) { var e = be.exec(t._i); null === e ? (Me(t), !1 === t._isValid && (delete t._isValid, xe(t), !1 === t._isValid && (delete t._isValid, n.createFromInputFallback(t)))) : t._d = new Date(+e[1]) }(t) : a(e) ? (t._a = l(e.slice(0), function (t) { return parseInt(t, 10) }), fe(t)) : r(e) ? function (t) { if (!t._d) { var e = P(t._i); t._a = l([e.year, e.month, e.day || e.date, e.hour, e.minute, e.second, e.millisecond], function (t) { return t && parseInt(t, 10) }), fe(t) } }(t) : h(e) ? t._d = new Date(e) : n.createFromInputFallback(t) }(t), g(t) || (t._d = null), t)) } function Oe(t, e, s, i, n) { var o, h = {}; return !0 !== s && !1 !== s || (i = s, s = void 0), (r(t) && function (t) { if (Object.getOwnPropertyNames) return 0 === Object.getOwnPropertyNames(t).length; var e; for (e in t) if (t.hasOwnProperty(e)) return !1; return !0 }(t) || a(t) && 0 === t.length) && (t = void 0), h._isAMomentObject = !0, h._useUTC = h._isUTC = n, h._l = s, h._i = t, h._f = e, h._strict = i, (o = new v(pe(Te(h))))._nextDay && (o.add(1, "d"), o._nextDay = void 0), o } function He(t, e, s, i) { return Oe(t, e, s, i, !1) } n.createFromInputFallback = Y("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.", function (t) { t._d = new Date(t._i + (t._useUTC ? " UTC" : "")) }), n.ISO_8601 = function () { }, n.RFC_2822 = function () { }; var We = Y("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/", function () { var t = He.apply(null, arguments); return this.isValid() && t.isValid() ? t < this ? this : t : f() }), Le = Y("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/", function () { var t = He.apply(null, arguments); return this.isValid() && t.isValid() ? t > this ? this : t : f() }); function Ce(t, e) { var s, i; if (1 === e.length && a(e[0]) && (e = e[0]), !e.length) return He(); for (s = e[0], i = 1; i < e.length; ++i)e[i].isValid() && !e[i][t](s) || (s = e[i]); return s } var Ee = ["year", "quarter", "month", "week", "day", "hour", "minute", "second", "millisecond"]; function Pe(t) { var e = P(t), s = e.year || 0, i = e.quarter || 0, n = e.month || 0, a = e.week || e.isoWeek || 0, r = e.day || 0, o = e.hour || 0, h = e.minute || 0, d = e.second || 0, l = e.millisecond || 0; this._isValid = function (t) { for (var e in t) if (-1 === $t.call(Ee, e) || null != t[e] && isNaN(t[e])) return !1; for (var s = !1, i = 0; i < Ee.length; ++i)if (t[Ee[i]]) { if (s) return !1; parseFloat(t[Ee[i]]) !== M(t[Ee[i]]) && (s = !0) } return !0 }(e), this._milliseconds = +l + 1e3 * d + 6e4 * h + 1e3 * o * 60 * 60, this._days = +r + 7 * a, this._months = +n + 3 * i + 12 * s, this._data = {}, this._locale = ce(), this._bubble() } function Ae(t) { return t instanceof Pe } function Fe(t) { return t < 0 ? -1 * Math.round(-1 * t) : Math.round(t) } function Re(t, e) { I(t, 0, 0, function () { var t = this.utcOffset(), s = "+"; return t < 0 && (t = -t, s = "-"), s + R(~~(t / 60), 2) + e + R(~~t % 60, 2) }) } Re("Z", ":"), Re("ZZ", ""), lt("Z", ot), lt("ZZ", ot), pt(["Z", "ZZ"], function (t, e, s) { s._useUTC = !0, s._tzm = Ue(ot, t) }); var Ne = /([\+\-]|\d\d)/gi; function Ue(t, e) { var s = (e || "").match(t); if (null === s) return null; var i = s[s.length - 1] || [], n = (i + "").match(Ne) || ["-", 0, 0], a = 60 * n[1] + M(n[2]); return 0 === a ? 0 : "+" === n[0] ? a : -a } function Ge(t, e) { var s, i; return e._isUTC ? (s = e.clone(), i = (k(t) || d(t) ? t.valueOf() : He(t).valueOf()) - s.valueOf(), s._d.setTime(s._d.valueOf() + i), n.updateOffset(s, !1), s) : He(t).local() } function Ve(t) { return 15 * -Math.round(t._d.getTimezoneOffset() / 15) } function Ie() { return !!this.isValid() && this._isUTC && 0 === this._offset } n.updateOffset = function () { }; var je = /^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/, ze = /^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/; function Ze(t, e) { var s, i, n, a, r, o, d = t, l = null; return Ae(t) ? d = { ms: t._milliseconds, d: t._days, M: t._months } : h(t) ? (d = {}, e ? d[e] = t : d.milliseconds = t) : (l = je.exec(t)) ? (s = "-" === l[1] ? -1 : 1, d = { y: 0, d: M(l[yt]) * s, h: M(l[vt]) * s, m: M(l[kt]) * s, s: M(l[bt]) * s, ms: M(Fe(1e3 * l[Mt])) * s }) : (l = ze.exec(t)) ? (s = "-" === l[1] ? -1 : 1, d = { y: Xe(l[2], s), M: Xe(l[3], s), w: Xe(l[4], s), d: Xe(l[5], s), h: Xe(l[6], s), m: Xe(l[7], s), s: Xe(l[8], s) }) : null == d ? d = {} : "object" == typeof d && ("from" in d || "to" in d) && (a = He(d.from), r = He(d.to), n = a.isValid() && r.isValid() ? (r = Ge(r, a), a.isBefore(r) ? o = qe(a, r) : ((o = qe(r, a)).milliseconds = -o.milliseconds, o.months = -o.months), o) : { milliseconds: 0, months: 0 }, (d = {}).ms = n.milliseconds, d.M = n.months), i = new Pe(d), Ae(t) && u(t, "_locale") && (i._locale = t._locale), i } function Xe(t, e) { var s = t && parseFloat(t.replace(",", ".")); return (isNaN(s) ? 0 : s) * e } function qe(t, e) { var s = {}; return s.months = e.month() - t.month() + 12 * (e.year() - t.year()), t.clone().add(s.months, "M").isAfter(e) && --s.months, s.milliseconds = +e - +t.clone().add(s.months, "M"), s } function Be(t, e) { return function (s, i) { var n; return null === i || isNaN(+i) || (T(e, "moment()." + e + "(period, number) is deprecated. Please use moment()." + e + "(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."), n = s, s = i, i = n), Je(this, Ze(s = "string" == typeof s ? +s : s, i), t), this } } function Je(t, e, s, i) { var a = e._milliseconds, r = Fe(e._days), o = Fe(e._months); t.isValid() && (i = null == i || i, o && At(t, Ht(t, "Month") + o * s), r && Wt(t, "Date", Ht(t, "Date") + r * s), a && t._d.setTime(t._d.valueOf() + a * s), i && n.updateOffset(t, r || o)) } Ze.fn = Pe.prototype, Ze.invalid = function () { return Ze(NaN) }; var Qe = Be(1, "add"), Ke = Be(-1, "subtract"); function ts(t, e) { var s, i, n = 12 * (e.year() - t.year()) + (e.month() - t.month()), a = t.clone().add(n, "months"); return e - a < 0 ? (s = t.clone().add(n - 1, "months"), i = (e - a) / (a - s)) : (s = t.clone().add(n + 1, "months"), i = (e - a) / (s - a)), -(n + i) || 0 } function es(t) { var e; return void 0 === t ? this._locale._abbr : (null != (e = ce(t)) && (this._locale = e), this) } n.defaultFormat = "YYYY-MM-DDTHH:mm:ssZ", n.defaultFormatUtc = "YYYY-MM-DDTHH:mm:ss[Z]"; var ss = Y("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.", function (t) { return void 0 === t ? this.localeData() : this.locale(t) }); function is() { return this._locale } var ns = 1e3, as = 60 * ns, rs = 60 * as, os = 3506328 * rs; function hs(t, e) { return (t % e + e) % e } function ds(t, e, s) { return t < 100 && t >= 0 ? new Date(t + 400, e, s) - os : new Date(t, e, s).valueOf() } function ls(t, e, s) { return t < 100 && t >= 0 ? Date.UTC(t + 400, e, s) - os : Date.UTC(t, e, s) } function us(t, e) { I(0, [t, t.length], 0, e) } function _s(t, e, s, i, n) { var a; return null == t ? jt(this, i, n).year : (a = zt(t, i, n), e > a && (e = a), function (t, e, s, i, n) { var a = It(t, e, s, i, n), r = Gt(a.year, 0, a.dayOfYear); return this.year(r.getUTCFullYear()), this.month(r.getUTCMonth()), this.date(r.getUTCDate()), this }.call(this, t, e, s, i, n)) } I(0, ["gg", 2], 0, function () { return this.weekYear() % 100 }), I(0, ["GG", 2], 0, function () { return this.isoWeekYear() % 100 }), us("gggg", "weekYear"), us("ggggg", "weekYear"), us("GGGG", "isoWeekYear"), us("GGGGG", "isoWeekYear"), C("weekYear", "gg"), C("isoWeekYear", "GG"), F("weekYear", 1), F("isoWeekYear", 1), lt("G", at), lt("g", at), lt("GG", Q, X), lt("gg", Q, X), lt("GGGG", st, B), lt("gggg", st, B), lt("GGGGG", it, J), lt("ggggg", it, J), gt(["gggg", "ggggg", "GGGG", "GGGGG"], function (t, e, s, i) { e[i.substr(0, 2)] = M(t) }), gt(["gg", "GG"], function (t, e, s, i) { e[i] = n.parseTwoDigitYear(t) }), I("Q", 0, "Qo", "quarter"), C("quarter", "Q"), F("quarter", 7), lt("Q", Z), pt("Q", function (t, e) { e[wt] = 3 * (M(t) - 1) }), I("D", ["DD", 2], "Do", "date"), C("date", "D"), F("date", 9), lt("D", Q), lt("DD", Q, X), lt("Do", function (t, e) { return t ? e._dayOfMonthOrdinalParse || e._ordinalParse : e._dayOfMonthOrdinalParseLenient }), pt(["D", "DD"], yt), pt("Do", function (t, e) { e[yt] = M(t.match(Q)[0]) }); var cs = Ot("Date", !0); I("DDD", ["DDDD", 3], "DDDo", "dayOfYear"), C("dayOfYear", "DDD"), F("dayOfYear", 4), lt("DDD", et), lt("DDDD", q), pt(["DDD", "DDDD"], function (t, e, s) { s._dayOfYear = M(t) }), I("m", ["mm", 2], 0, "minute"), C("minute", "m"), F("minute", 14), lt("m", Q), lt("mm", Q, X), pt(["m", "mm"], kt); var ps = Ot("Minutes", !1); I("s", ["ss", 2], 0, "second"), C("second", "s"), F("second", 15), lt("s", Q), lt("ss", Q, X), pt(["s", "ss"], bt); var gs, fs = Ot("Seconds", !1); for (I("S", 0, 0, function () { return ~~(this.millisecond() / 100) }), I(0, ["SS", 2], 0, function () { return ~~(this.millisecond() / 10) }), I(0, ["SSS", 3], 0, "millisecond"), I(0, ["SSSS", 4], 0, function () { return 10 * this.millisecond() }), I(0, ["SSSSS", 5], 0, function () { return 100 * this.millisecond() }), I(0, ["SSSSSS", 6], 0, function () { return 1e3 * this.millisecond() }), I(0, ["SSSSSSS", 7], 0, function () { return 1e4 * this.millisecond() }), I(0, ["SSSSSSSS", 8], 0, function () { return 1e5 * this.millisecond() }), I(0, ["SSSSSSSSS", 9], 0, function () { return 1e6 * this.millisecond() }), C("millisecond", "ms"), F("millisecond", 16), lt("S", et, Z), lt("SS", et, X), lt("SSS", et, q), gs = "SSSS"; gs.length <= 9; gs += "S")lt(gs, nt); function ms(t, e) { e[Mt] = M(1e3 * ("0." + t)) } for (gs = "S"; gs.length <= 9; gs += "S")pt(gs, ms); var ws = Ot("Milliseconds", !1); I("z", 0, 0, "zoneAbbr"), I("zz", 0, 0, "zoneName"); var ys = v.prototype; function vs(t) { return t } ys.add = Qe, ys.calendar = function (t, e) { var s = t || He(), i = Ge(s, this).startOf("day"), a = n.calendarFormat(this, i) || "sameElse", r = e && (O(e[a]) ? e[a].call(this, s) : e[a]); return this.format(r || this.localeData().calendar(a, this, He(s))) }, ys.clone = function () { return new v(this) }, ys.diff = function (t, e, s) { var i, n, a; if (!this.isValid()) return NaN; if (!(i = Ge(t, this)).isValid()) return NaN; switch (n = 6e4 * (i.utcOffset() - this.utcOffset()), e = E(e)) { case "year": a = ts(this, i) / 12; break; case "month": a = ts(this, i); break; case "quarter": a = ts(this, i) / 3; break; case "second": a = (this - i) / 1e3; break; case "minute": a = (this - i) / 6e4; break; case "hour": a = (this - i) / 36e5; break; case "day": a = (this - i - n) / 864e5; break; case "week": a = (this - i - n) / 6048e5; break; default: a = this - i }return s ? a : b(a) }, ys.endOf = function (t) { var e; if (void 0 === (t = E(t)) || "millisecond" === t || !this.isValid()) return this; var s = this._isUTC ? ls : ds; switch (t) { case "year": e = s(this.year() + 1, 0, 1) - 1; break; case "quarter": e = s(this.year(), this.month() - this.month() % 3 + 3, 1) - 1; break; case "month": e = s(this.year(), this.month() + 1, 1) - 1; break; case "week": e = s(this.year(), this.month(), this.date() - this.weekday() + 7) - 1; break; case "isoWeek": e = s(this.year(), this.month(), this.date() - (this.isoWeekday() - 1) + 7) - 1; break; case "day": case "date": e = s(this.year(), this.month(), this.date() + 1) - 1; break; case "hour": e = this._d.valueOf(), e += rs - hs(e + (this._isUTC ? 0 : this.utcOffset() * as), rs) - 1; break; case "minute": e = this._d.valueOf(), e += as - hs(e, as) - 1; break; case "second": e = this._d.valueOf(), e += ns - hs(e, ns) - 1 }return this._d.setTime(e), n.updateOffset(this, !0), this }, ys.format = function (t) { t || (t = this.isUtc() ? n.defaultFormatUtc : n.defaultFormat); var e = j(this, t); return this.localeData().postformat(e) }, ys.from = function (t, e) { return this.isValid() && (k(t) && t.isValid() || He(t).isValid()) ? Ze({ to: this, from: t }).locale(this.locale()).humanize(!e) : this.localeData().invalidDate() }, ys.fromNow = function (t) { return this.from(He(), t) }, ys.to = function (t, e) { return this.isValid() && (k(t) && t.isValid() || He(t).isValid()) ? Ze({ from: this, to: t }).locale(this.locale()).humanize(!e) : this.localeData().invalidDate() }, ys.toNow = function (t) { return this.to(He(), t) }, ys.get = function (t) { return O(this[t = E(t)]) ? this[t]() : this }, ys.invalidAt = function () { return p(this).overflow }, ys.isAfter = function (t, e) { var s = k(t) ? t : He(t); return !(!this.isValid() || !s.isValid()) && ("millisecond" === (e = E(e) || "millisecond") ? this.valueOf() > s.valueOf() : s.valueOf() < this.clone().startOf(e).valueOf()) }, ys.isBefore = function (t, e) { var s = k(t) ? t : He(t); return !(!this.isValid() || !s.isValid()) && ("millisecond" === (e = E(e) || "millisecond") ? this.valueOf() < s.valueOf() : this.clone().endOf(e).valueOf() < s.valueOf()) }, ys.isBetween = function (t, e, s, i) { var n = k(t) ? t : He(t), a = k(e) ? e : He(e); return !!(this.isValid() && n.isValid() && a.isValid()) && (("(" === (i = i || "()")[0] ? this.isAfter(n, s) : !this.isBefore(n, s)) && (")" === i[1] ? this.isBefore(a, s) : !this.isAfter(a, s))) }, ys.isSame = function (t, e) { var s, i = k(t) ? t : He(t); return !(!this.isValid() || !i.isValid()) && ("millisecond" === (e = E(e) || "millisecond") ? this.valueOf() === i.valueOf() : (s = i.valueOf(), this.clone().startOf(e).valueOf() <= s && s <= this.clone().endOf(e).valueOf())) }, ys.isSameOrAfter = function (t, e) { return this.isSame(t, e) || this.isAfter(t, e) }, ys.isSameOrBefore = function (t, e) { return this.isSame(t, e) || this.isBefore(t, e) }, ys.isValid = function () { return g(this) }, ys.lang = ss, ys.locale = es, ys.localeData = is, ys.max = Le, ys.min = We, ys.parsingFlags = function () { return _({}, p(this)) }, ys.set = function (t, e) { if ("object" == typeof t) for (var s = function (t) { var e = []; for (var s in t) e.push({ unit: s, priority: A[s] }); return e.sort(function (t, e) { return t.priority - e.priority }), e }(t = P(t)), i = 0; i < s.length; i++)this[s[i].unit](t[s[i].unit]); else if (O(this[t = E(t)])) return this[t](e); return this }, ys.startOf = function (t) { var e; if (void 0 === (t = E(t)) || "millisecond" === t || !this.isValid()) return this; var s = this._isUTC ? ls : ds; switch (t) { case "year": e = s(this.year(), 0, 1); break; case "quarter": e = s(this.year(), this.month() - this.month() % 3, 1); break; case "month": e = s(this.year(), this.month(), 1); break; case "week": e = s(this.year(), this.month(), this.date() - this.weekday()); break; case "isoWeek": e = s(this.year(), this.month(), this.date() - (this.isoWeekday() - 1)); break; case "day": case "date": e = s(this.year(), this.month(), this.date()); break; case "hour": e = this._d.valueOf(), e -= hs(e + (this._isUTC ? 0 : this.utcOffset() * as), rs); break; case "minute": e = this._d.valueOf(), e -= hs(e, as); break; case "second": e = this._d.valueOf(), e -= hs(e, ns) }return this._d.setTime(e), n.updateOffset(this, !0), this }, ys.subtract = Ke, ys.toArray = function () { var t = this; return [t.year(), t.month(), t.date(), t.hour(), t.minute(), t.second(), t.millisecond()] }, ys.toObject = function () { var t = this; return { years: t.year(), months: t.month(), date: t.date(), hours: t.hours(), minutes: t.minutes(), seconds: t.seconds(), milliseconds: t.milliseconds() } }, ys.toDate = function () { return new Date(this.valueOf()) }, ys.toISOString = function (t) { if (!this.isValid()) return null; var e = !0 !== t, s = e ? this.clone().utc() : this; return s.year() < 0 || s.year() > 9999 ? j(s, e ? "YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]" : "YYYYYY-MM-DD[T]HH:mm:ss.SSSZ") : O(Date.prototype.toISOString) ? e ? this.toDate().toISOString() : new Date(this.valueOf() + 60 * this.utcOffset() * 1e3).toISOString().replace("Z", j(s, "Z")) : j(s, e ? "YYYY-MM-DD[T]HH:mm:ss.SSS[Z]" : "YYYY-MM-DD[T]HH:mm:ss.SSSZ") }, ys.inspect = function () { if (!this.isValid()) return "moment.invalid(/* " + this._i + " */)"; var t = "moment", e = ""; this.isLocal() || (t = 0 === this.utcOffset() ? "moment.utc" : "moment.parseZone", e = "Z"); var s = "[" + t + '("]', i = 0 <= this.year() && this.year() <= 9999 ? "YYYY" : "YYYYYY", n = e + '[")]'; return this.format(s + i + "-MM-DD[T]HH:mm:ss.SSS" + n) }, ys.toJSON = function () { return this.isValid() ? this.toISOString() : null }, ys.toString = function () { return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ") }, ys.unix = function () { return Math.floor(this.valueOf() / 1e3) }, ys.valueOf = function () { return this._d.valueOf() - 6e4 * (this._offset || 0) }, ys.creationData = function () { return { input: this._i, format: this._f, locale: this._locale, isUTC: this._isUTC, strict: this._strict } }, ys.year = Tt, ys.isLeapYear = function () { return xt(this.year()) }, ys.weekYear = function (t) { return _s.call(this, t, this.week(), this.weekday(), this.localeData()._week.dow, this.localeData()._week.doy) }, ys.isoWeekYear = function (t) { return _s.call(this, t, this.isoWeek(), this.isoWeekday(), 1, 4) }, ys.quarter = ys.quarters = function (t) { return null == t ? Math.ceil((this.month() + 1) / 3) : this.month(3 * (t - 1) + this.month() % 3) }, ys.month = Ft, ys.daysInMonth = function () { return Lt(this.year(), this.month()) }, ys.week = ys.weeks = function (t) { var e = this.localeData().week(this); return null == t ? e : this.add(7 * (t - e), "d") }, ys.isoWeek = ys.isoWeeks = function (t) { var e = jt(this, 1, 4).week; return null == t ? e : this.add(7 * (t - e), "d") }, ys.weeksInYear = function () { var t = this.localeData()._week; return zt(this.year(), t.dow, t.doy) }, ys.isoWeeksInYear = function () { return zt(this.year(), 1, 4) }, ys.date = cs, ys.day = ys.days = function (t) { if (!this.isValid()) return null != t ? this : NaN; var e = this._isUTC ? this._d.getUTCDay() : this._d.getDay(); return null != t ? (t = function (t, e) { return "string" != typeof t ? t : isNaN(t) ? "number" == typeof (t = e.weekdaysParse(t)) ? t : null : parseInt(t, 10) }(t, this.localeData()), this.add(t - e, "d")) : e }, ys.weekday = function (t) { if (!this.isValid()) return null != t ? this : NaN; var e = (this.day() + 7 - this.localeData()._week.dow) % 7; return null == t ? e : this.add(t - e, "d") }, ys.isoWeekday = function (t) { if (!this.isValid()) return null != t ? this : NaN; if (null != t) { var e = function (t, e) { return "string" == typeof t ? e.weekdaysParse(t) % 7 || 7 : isNaN(t) ? null : t }(t, this.localeData()); return this.day(this.day() % 7 ? e : e - 7) } return this.day() || 7 }, ys.dayOfYear = function (t) { var e = Math.round((this.clone().startOf("day") - this.clone().startOf("year")) / 864e5) + 1; return null == t ? e : this.add(t - e, "d") }, ys.hour = ys.hours = ae, ys.minute = ys.minutes = ps, ys.second = ys.seconds = fs, ys.millisecond = ys.milliseconds = ws, ys.utcOffset = function (t, e, s) { var i, a = this._offset || 0; if (!this.isValid()) return null != t ? this : NaN; if (null != t) { if ("string" == typeof t) { if (null === (t = Ue(ot, t))) return this } else Math.abs(t) < 16 && !s && (t *= 60); return !this._isUTC && e && (i = Ve(this)), this._offset = t, this._isUTC = !0, null != i && this.add(i, "m"), a !== t && (!e || this._changeInProgress ? Je(this, Ze(t - a, "m"), 1, !1) : this._changeInProgress || (this._changeInProgress = !0, n.updateOffset(this, !0), this._changeInProgress = null)), this } return this._isUTC ? a : Ve(this) }, ys.utc = function (t) { return this.utcOffset(0, t) }, ys.local = function (t) { return this._isUTC && (this.utcOffset(0, t), this._isUTC = !1, t && this.subtract(Ve(this), "m")), this }, ys.parseZone = function () { if (null != this._tzm) this.utcOffset(this._tzm, !1, !0); else if ("string" == typeof this._i) { var t = Ue(rt, this._i); null != t ? this.utcOffset(t) : this.utcOffset(0, !0) } return this }, ys.hasAlignedHourOffset = function (t) { return !!this.isValid() && (t = t ? He(t).utcOffset() : 0, (this.utcOffset() - t) % 60 == 0) }, ys.isDST = function () { return this.utcOffset() > this.clone().month(0).utcOffset() || this.utcOffset() > this.clone().month(5).utcOffset() }, ys.isLocal = function () { return !!this.isValid() && !this._isUTC }, ys.isUtcOffset = function () { return !!this.isValid() && this._isUTC }, ys.isUtc = Ie, ys.isUTC = Ie, ys.zoneAbbr = function () { return this._isUTC ? "UTC" : "" }, ys.zoneName = function () { return this._isUTC ? "Coordinated Universal Time" : "" }, ys.dates = Y("dates accessor is deprecated. Use date instead.", cs), ys.months = Y("months accessor is deprecated. Use month instead", Ft), ys.years = Y("years accessor is deprecated. Use year instead", Tt), ys.zone = Y("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/", function (t, e) { return null != t ? ("string" != typeof t && (t = -t), this.utcOffset(t, e), this) : -this.utcOffset() }), ys.isDSTShifted = Y("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information", function () { if (!o(this._isDSTShifted)) return this._isDSTShifted; var t = {}; if (w(t, this), (t = Te(t))._a) { var e = t._isUTC ? c(t._a) : He(t._a); this._isDSTShifted = this.isValid() && D(t._a, e.toArray()) > 0 } else this._isDSTShifted = !1; return this._isDSTShifted }); var ks = W.prototype; function bs(t, e, s, i) { var n = ce(), a = c().set(i, e); return n[s](a, t) } function Ms(t, e, s) { if (h(t) && (e = t, t = void 0), t = t || "", null != e) return bs(t, e, s, "month"); var i, n = []; for (i = 0; i < 12; i++)n[i] = bs(t, i, s, "month"); return n } function Ds(t, e, s, i) { "boolean" == typeof t ? (h(e) && (s = e, e = void 0), e = e || "") : (s = e = t, t = !1, h(e) && (s = e, e = void 0), e = e || ""); var n, a = ce(), r = t ? a._week.dow : 0; if (null != s) return bs(e, (s + r) % 7, i, "day"); var o = []; for (n = 0; n < 7; n++)o[n] = bs(e, (n + r) % 7, i, "day"); return o } ks.calendar = function (t, e, s) { var i = this._calendar[t] || this._calendar.sameElse; return O(i) ? i.call(e, s) : i }, ks.longDateFormat = function (t) { var e = this._longDateFormat[t], s = this._longDateFormat[t.toUpperCase()]; return e || !s ? e : (this._longDateFormat[t] = s.replace(/MMMM|MM|DD|dddd/g, function (t) { return t.slice(1) }), this._longDateFormat[t]) }, ks.invalidDate = function () { return this._invalidDate }, ks.ordinal = function (t) { return this._ordinal.replace("%d", t) }, ks.preparse = vs, ks.postformat = vs, ks.relativeTime = function (t, e, s, i) { var n = this._relativeTime[s]; return O(n) ? n(t, e, s, i) : n.replace(/%d/i, t) }, ks.pastFuture = function (t, e) { var s = this._relativeTime[t > 0 ? "future" : "past"]; return O(s) ? s(e) : s.replace(/%s/i, e) }, ks.set = function (t) { var e, s; for (s in t) O(e = t[s]) ? this[s] = e : this["_" + s] = e; this._config = t, this._dayOfMonthOrdinalParseLenient = new RegExp((this._dayOfMonthOrdinalParse.source || this._ordinalParse.source) + "|" + /\d{1,2}/.source) }, ks.months = function (t, e) { return t ? a(this._months) ? this._months[t.month()] : this._months[(this._months.isFormat || Ct).test(e) ? "format" : "standalone"][t.month()] : a(this._months) ? this._months : this._months.standalone }, ks.monthsShort = function (t, e) { return t ? a(this._monthsShort) ? this._monthsShort[t.month()] : this._monthsShort[Ct.test(e) ? "format" : "standalone"][t.month()] : a(this._monthsShort) ? this._monthsShort : this._monthsShort.standalone }, ks.monthsParse = function (t, e, s) { var i, n, a; if (this._monthsParseExact) return function (t, e, s) { var i, n, a, r = t.toLocaleLowerCase(); if (!this._monthsParse) for (this._monthsParse = [], this._longMonthsParse = [], this._shortMonthsParse = [], i = 0; i < 12; ++i)a = c([2e3, i]), this._shortMonthsParse[i] = this.monthsShort(a, "").toLocaleLowerCase(), this._longMonthsParse[i] = this.months(a, "").toLocaleLowerCase(); return s ? "MMM" === e ? -1 !== (n = $t.call(this._shortMonthsParse, r)) ? n : null : -1 !== (n = $t.call(this._longMonthsParse, r)) ? n : null : "MMM" === e ? -1 !== (n = $t.call(this._shortMonthsParse, r)) ? n : -1 !== (n = $t.call(this._longMonthsParse, r)) ? n : null : -1 !== (n = $t.call(this._longMonthsParse, r)) ? n : -1 !== (n = $t.call(this._shortMonthsParse, r)) ? n : null }.call(this, t, e, s); for (this._monthsParse || (this._monthsParse = [], this._longMonthsParse = [], this._shortMonthsParse = []), i = 0; i < 12; i++) { if (n = c([2e3, i]), s && !this._longMonthsParse[i] && (this._longMonthsParse[i] = new RegExp("^" + this.months(n, "").replace(".", "") + "$", "i"), this._shortMonthsParse[i] = new RegExp("^" + this.monthsShort(n, "").replace(".", "") + "$", "i")), s || this._monthsParse[i] || (a = "^" + this.months(n, "") + "|^" + this.monthsShort(n, ""), this._monthsParse[i] = new RegExp(a.replace(".", ""), "i")), s && "MMMM" === e && this._longMonthsParse[i].test(t)) return i; if (s && "MMM" === e && this._shortMonthsParse[i].test(t)) return i; if (!s && this._monthsParse[i].test(t)) return i } }, ks.monthsRegex = function (t) { return this._monthsParseExact ? (u(this, "_monthsRegex") || Ut.call(this), t ? this._monthsStrictRegex : this._monthsRegex) : (u(this, "_monthsRegex") || (this._monthsRegex = Nt), this._monthsStrictRegex && t ? this._monthsStrictRegex : this._monthsRegex) }, ks.monthsShortRegex = function (t) { return this._monthsParseExact ? (u(this, "_monthsRegex") || Ut.call(this), t ? this._monthsShortStrictRegex : this._monthsShortRegex) : (u(this, "_monthsShortRegex") || (this._monthsShortRegex = Rt), this._monthsShortStrictRegex && t ? this._monthsShortStrictRegex : this._monthsShortRegex) }, ks.week = function (t) { return jt(t, this._week.dow, this._week.doy).week }, ks.firstDayOfYear = function () { return this._week.doy }, ks.firstDayOfWeek = function () { return this._week.dow }, ks.weekdays = function (t, e) { var s = a(this._weekdays) ? this._weekdays : this._weekdays[t && !0 !== t && this._weekdays.isFormat.test(e) ? "format" : "standalone"]; return !0 === t ? Zt(s, this._week.dow) : t ? s[t.day()] : s }, ks.weekdaysMin = function (t) { return !0 === t ? Zt(this._weekdaysMin, this._week.dow) : t ? this._weekdaysMin[t.day()] : this._weekdaysMin }, ks.weekdaysShort = function (t) { return !0 === t ? Zt(this._weekdaysShort, this._week.dow) : t ? this._weekdaysShort[t.day()] : this._weekdaysShort }, ks.weekdaysParse = function (t, e, s) { var i, n, a; if (this._weekdaysParseExact) return function (t, e, s) { var i, n, a, r = t.toLocaleLowerCase(); if (!this._weekdaysParse) for (this._weekdaysParse = [], this._shortWeekdaysParse = [], this._minWeekdaysParse = [], i = 0; i < 7; ++i)a = c([2e3, 1]).day(i), this._minWeekdaysParse[i] = this.weekdaysMin(a, "").toLocaleLowerCase(), this._shortWeekdaysParse[i] = this.weekdaysShort(a, "").toLocaleLowerCase(), this._weekdaysParse[i] = this.weekdays(a, "").toLocaleLowerCase(); return s ? "dddd" === e ? -1 !== (n = $t.call(this._weekdaysParse, r)) ? n : null : "ddd" === e ? -1 !== (n = $t.call(this._shortWeekdaysParse, r)) ? n : null : -1 !== (n = $t.call(this._minWeekdaysParse, r)) ? n : null : "dddd" === e ? -1 !== (n = $t.call(this._weekdaysParse, r)) ? n : -1 !== (n = $t.call(this._shortWeekdaysParse, r)) ? n : -1 !== (n = $t.call(this._minWeekdaysParse, r)) ? n : null : "ddd" === e ? -1 !== (n = $t.call(this._shortWeekdaysParse, r)) ? n : -1 !== (n = $t.call(this._weekdaysParse, r)) ? n : -1 !== (n = $t.call(this._minWeekdaysParse, r)) ? n : null : -1 !== (n = $t.call(this._minWeekdaysParse, r)) ? n : -1 !== (n = $t.call(this._weekdaysParse, r)) ? n : -1 !== (n = $t.call(this._shortWeekdaysParse, r)) ? n : null }.call(this, t, e, s); for (this._weekdaysParse || (this._weekdaysParse = [], this._minWeekdaysParse = [], this._shortWeekdaysParse = [], this._fullWeekdaysParse = []), i = 0; i < 7; i++) { if (n = c([2e3, 1]).day(i), s && !this._fullWeekdaysParse[i] && (this._fullWeekdaysParse[i] = new RegExp("^" + this.weekdays(n, "").replace(".", "\\.?") + "$", "i"), this._shortWeekdaysParse[i] = new RegExp("^" + this.weekdaysShort(n, "").replace(".", "\\.?") + "$", "i"), this._minWeekdaysParse[i] = new RegExp("^" + this.weekdaysMin(n, "").replace(".", "\\.?") + "$", "i")), this._weekdaysParse[i] || (a = "^" + this.weekdays(n, "") + "|^" + this.weekdaysShort(n, "") + "|^" + this.weekdaysMin(n, ""), this._weekdaysParse[i] = new RegExp(a.replace(".", ""), "i")), s && "dddd" === e && this._fullWeekdaysParse[i].test(t)) return i; if (s && "ddd" === e && this._shortWeekdaysParse[i].test(t)) return i; if (s && "dd" === e && this._minWeekdaysParse[i].test(t)) return i; if (!s && this._weekdaysParse[i].test(t)) return i } }, ks.weekdaysRegex = function (t) { return this._weekdaysParseExact ? (u(this, "_weekdaysRegex") || te.call(this), t ? this._weekdaysStrictRegex : this._weekdaysRegex) : (u(this, "_weekdaysRegex") || (this._weekdaysRegex = Jt), this._weekdaysStrictRegex && t ? this._weekdaysStrictRegex : this._weekdaysRegex) }, ks.weekdaysShortRegex = function (t) { return this._weekdaysParseExact ? (u(this, "_weekdaysRegex") || te.call(this), t ? this._weekdaysShortStrictRegex : this._weekdaysShortRegex) : (u(this, "_weekdaysShortRegex") || (this._weekdaysShortRegex = Qt), this._weekdaysShortStrictRegex && t ? this._weekdaysShortStrictRegex : this._weekdaysShortRegex) }, ks.weekdaysMinRegex = function (t) { return this._weekdaysParseExact ? (u(this, "_weekdaysRegex") || te.call(this), t ? this._weekdaysMinStrictRegex : this._weekdaysMinRegex) : (u(this, "_weekdaysMinRegex") || (this._weekdaysMinRegex = Kt), this._weekdaysMinStrictRegex && t ? this._weekdaysMinStrictRegex : this._weekdaysMinRegex) }, ks.isPM = function (t) { return "p" === (t + "").toLowerCase().charAt(0) }, ks.meridiem = function (t, e, s) { return t > 11 ? s ? "pm" : "PM" : s ? "am" : "AM" }, ue("en", { dayOfMonthOrdinalParse: /\d{1,2}(th|st|nd|rd)/, ordinal: function (t) { var e = t % 10, s = 1 === M(t % 100 / 10) ? "th" : 1 === e ? "st" : 2 === e ? "nd" : 3 === e ? "rd" : "th"; return t + s } }), n.lang = Y("moment.lang is deprecated. Use moment.locale instead.", ue), n.langData = Y("moment.langData is deprecated. Use moment.localeData instead.", ce); var Ss = Math.abs; function Ys(t, e, s, i) { var n = Ze(e, s); return t._milliseconds += i * n._milliseconds, t._days += i * n._days, t._months += i * n._months, t._bubble() } function xs(t) { return t < 0 ? Math.floor(t) : Math.ceil(t) } function $s(t) { return 4800 * t / 146097 } function Ts(t) { return 146097 * t / 4800 } function Os(t) { return function () { return this.as(t) } } var Hs = Os("ms"), Ws = Os("s"), Ls = Os("m"), Cs = Os("h"), Es = Os("d"), Ps = Os("w"), As = Os("M"), Fs = Os("Q"), Rs = Os("y"); function Ns(t) { return function () { return this.isValid() ? this._data[t] : NaN } } var Us = Ns("milliseconds"), Gs = Ns("seconds"), Vs = Ns("minutes"), Is = Ns("hours"), js = Ns("days"), zs = Ns("months"), Zs = Ns("years"), Xs = Math.round, qs = { ss: 44, s: 45, m: 45, h: 22, d: 26, M: 11 }, Bs = Math.abs; function Js(t) { return (t > 0) - (t < 0) || +t } function Qs() { if (!this.isValid()) return this.localeData().invalidDate(); var t, e, s = Bs(this._milliseconds) / 1e3, i = Bs(this._days), n = Bs(this._months); t = b(s / 60), e = b(t / 60), s %= 60, t %= 60; var a = b(n / 12), r = n %= 12, o = i, h = e, d = t, l = s ? s.toFixed(3).replace(/\.?0+$/, "") : "", u = this.asSeconds(); if (!u) return "P0D"; var _ = u < 0 ? "-" : "", c = Js(this._months) !== Js(u) ? "-" : "", p = Js(this._days) !== Js(u) ? "-" : "", g = Js(this._milliseconds) !== Js(u) ? "-" : ""; return _ + "P" + (a ? c + a + "Y" : "") + (r ? c + r + "M" : "") + (o ? p + o + "D" : "") + (h || d || l ? "T" : "") + (h ? g + h + "H" : "") + (d ? g + d + "M" : "") + (l ? g + l + "S" : "") } var Ks = Pe.prototype; return Ks.isValid = function () { return this._isValid }, Ks.abs = function () { var t = this._data; return this._milliseconds = Ss(this._milliseconds), this._days = Ss(this._days), this._months = Ss(this._months), t.milliseconds = Ss(t.milliseconds), t.seconds = Ss(t.seconds), t.minutes = Ss(t.minutes), t.hours = Ss(t.hours), t.months = Ss(t.months), t.years = Ss(t.years), this }, Ks.add = function (t, e) { return Ys(this, t, e, 1) }, Ks.subtract = function (t, e) { return Ys(this, t, e, -1) }, Ks.as = function (t) { if (!this.isValid()) return NaN; var e, s, i = this._milliseconds; if ("month" === (t = E(t)) || "quarter" === t || "year" === t) switch (e = this._days + i / 864e5, s = this._months + $s(e), t) { case "month": return s; case "quarter": return s / 3; case "year": return s / 12 } else switch (e = this._days + Math.round(Ts(this._months)), t) { case "week": return e / 7 + i / 6048e5; case "day": return e + i / 864e5; case "hour": return 24 * e + i / 36e5; case "minute": return 1440 * e + i / 6e4; case "second": return 86400 * e + i / 1e3; case "millisecond": return Math.floor(864e5 * e) + i; default: throw new Error("Unknown unit " + t) } }, Ks.asMilliseconds = Hs, Ks.asSeconds = Ws, Ks.asMinutes = Ls, Ks.asHours = Cs, Ks.asDays = Es, Ks.asWeeks = Ps, Ks.asMonths = As, Ks.asQuarters = Fs, Ks.asYears = Rs, Ks.valueOf = function () { return this.isValid() ? this._milliseconds + 864e5 * this._days + this._months % 12 * 2592e6 + 31536e6 * M(this._months / 12) : NaN }, Ks._bubble = function () { var t, e, s, i, n, a = this._milliseconds, r = this._days, o = this._months, h = this._data; return a >= 0 && r >= 0 && o >= 0 || a <= 0 && r <= 0 && o <= 0 || (a += 864e5 * xs(Ts(o) + r), r = 0, o = 0), h.milliseconds = a % 1e3, t = b(a / 1e3), h.seconds = t % 60, e = b(t / 60), h.minutes = e % 60, s = b(e / 60), h.hours = s % 24, r += b(s / 24), n = b($s(r)), o += n, r -= xs(Ts(n)), i = b(o / 12), o %= 12, h.days = r, h.months = o, h.years = i, this }, Ks.clone = function () { return Ze(this) }, Ks.get = function (t) { return t = E(t), this.isValid() ? this[t + "s"]() : NaN }, Ks.milliseconds = Us, Ks.seconds = Gs, Ks.minutes = Vs, Ks.hours = Is, Ks.days = js, Ks.weeks = function () { return b(this.days() / 7) }, Ks.months = zs, Ks.years = Zs, Ks.humanize = function (t) { if (!this.isValid()) return this.localeData().invalidDate(); var e = this.localeData(), s = function (t, e, s) { var i = Ze(t).abs(), n = Xs(i.as("s")), a = Xs(i.as("m")), r = Xs(i.as("h")), o = Xs(i.as("d")), h = Xs(i.as("M")), d = Xs(i.as("y")), l = n <= qs.ss && ["s", n] || n < qs.s && ["ss", n] || a <= 1 && ["m"] || a < qs.m && ["mm", a] || r <= 1 && ["h"] || r < qs.h && ["hh", r] || o <= 1 && ["d"] || o < qs.d && ["dd", o] || h <= 1 && ["M"] || h < qs.M && ["MM", h] || d <= 1 && ["y"] || ["yy", d]; return l[2] = e, l[3] = +t > 0, l[4] = s, function (t, e, s, i, n) { return n.relativeTime(e || 1, !!s, t, i) }.apply(null, l) }(this, !t, e); return t && (s = e.pastFuture(+this, s)), e.postformat(s) }, Ks.toISOString = Qs, Ks.toString = Qs, Ks.toJSON = Qs, Ks.locale = es, Ks.localeData = is, Ks.toIsoString = Y("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)", Qs), Ks.lang = ss, I("X", 0, 0, "unix"), I("x", 0, 0, "valueOf"), lt("x", at), lt("X", /[+-]?\d+(\.\d{1,3})?/), pt("X", function (t, e, s) { s._d = new Date(1e3 * parseFloat(t, 10)) }), pt("x", function (t, e, s) { s._d = new Date(M(t)) }), n.version = "2.24.0", s = He, n.fn = ys, n.min = function () { return Ce("isBefore", [].slice.call(arguments, 0)) }, n.max = function () { return Ce("isAfter", [].slice.call(arguments, 0)) }, n.now = function () { return Date.now ? Date.now() : +new Date }, n.utc = c, n.unix = function (t) { return He(1e3 * t) }, n.months = function (t, e) { return Ms(t, e, "months") }, n.isDate = d, n.locale = ue, n.invalid = f, n.duration = Ze, n.isMoment = k, n.weekdays = function (t, e, s) { return Ds(t, e, s, "weekdays") }, n.parseZone = function () { return He.apply(null, arguments).parseZone() }, n.localeData = ce, n.isDuration = Ae, n.monthsShort = function (t, e) { return Ms(t, e, "monthsShort") }, n.weekdaysMin = function (t, e, s) { return Ds(t, e, s, "weekdaysMin") }, n.defineLocale = _e, n.updateLocale = function (t, e) { if (null != e) { var s, i, n = re; null != (i = le(t)) && (n = i._config), e = H(n, e), (s = new W(e)).parentLocale = oe[t], oe[t] = s, ue(t) } else null != oe[t] && (null != oe[t].parentLocale ? oe[t] = oe[t].parentLocale : null != oe[t] && delete oe[t]); return oe[t] }, n.locales = function () { return x(oe) }, n.weekdaysShort = function (t, e, s) { return Ds(t, e, s, "weekdaysShort") }, n.normalizeUnits = E, n.relativeTimeRounding = function (t) { return void 0 === t ? Xs : "function" == typeof t && (Xs = t, !0) }, n.relativeTimeThreshold = function (t, e) { return void 0 !== qs[t] && (void 0 === e ? qs[t] : (qs[t] = e, "s" === t && (qs.ss = e - 1), !0)) }, n.calendarFormat = function (t, e) { var s = t.diff(e, "days", !0); return s < -6 ? "sameElse" : s < -1 ? "lastWeek" : s < 0 ? "lastDay" : s < 1 ? "sameDay" : s < 2 ? "nextDay" : s < 7 ? "nextWeek" : "sameElse" }, n.prototype = ys, n.HTML5_FMT = { DATETIME_LOCAL: "YYYY-MM-DDTHH:mm", DATETIME_LOCAL_SECONDS: "YYYY-MM-DDTHH:mm:ss", DATETIME_LOCAL_MS: "YYYY-MM-DDTHH:mm:ss.SSS", DATE: "YYYY-MM-DD", TIME: "HH:mm", TIME_SECONDS: "HH:mm:ss", TIME_MS: "HH:mm:ss.SSS", WEEK: "GGGG-[W]WW", MONTH: "YYYY-MM" }, n }() }(e = { exports: {} }, e.exports), e.exports); const i = { en: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"], ru: ["Январь", "Февраль", "Март", "Апрель", "Май", "Июнь", "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь"], ptBr: ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"], cs: ["Leden", "Únor", "Březen", "Duben", "Květen", "Červen", "Červenec", "Srpen", "Září", "Říjen", "Listopad", "Prosinec"] }, n = { en: "MMM D", cs: "D. MMM" }; var a = { parse(t, e = "-", s = /[.:]/) { if (t instanceof Date) return t; if ("string" == typeof t) { let i, n; const a = t.split(" "); i = a[0].split(e).map(t => parseInt(t, 10)), n = a[1] && a[1].split(s), i[1] = i[1] - 1; let r = i; return n && n.length && (4 === n.length && (n[3] = "0." + n[3], n[3] = 1e3 * parseFloat(n[3])), r = r.concat(n)), new Date(...r) } }, to_string(t, e = !1) { if (!(t instanceof Date)) throw new TypeError("Invalid argument type"); const s = this.get_date_values(t).map((t, e) => (1 === e && (t += 1), r(t + "", 6 === e ? 3 : 2, "0"))), i = `${s[0]}-${s[1]}-${s[2]}`, n = `${s[3]}:${s[4]}:${s[5]}.${s[6]}`; return i + (e ? " " + n : "") }, format(t, e = "YYYY-MM-DD HH:mm:ss.SSS", s = "en") { const a = this.get_date_values(t).map(t => r(t, 2, 0)); e = "" === e ? n[s] : e; const o = { YYYY: a[0], MM: r(+a[1] + 1, 2, 0), DD: a[2], HH: a[3], mm: a[4], ss: a[5], SSS: a[6], D: a[2], MMMM: i[s][+a[1]], MMM: i[s][+a[1]] }; let h = e; const d = []; return Object.keys(o).sort((t, e) => e.length - t.length).forEach(t => { h.includes(t) && (h = h.replace(t, `$${d.length}`), d.push(o[t])) }), d.forEach((t, e) => { h = h.replace(`$${e}`, t) }), h }, diff(t, e, i = "day") { let n, a, r, o, h, d, l; const u = s(t), _ = s(e); return h = u.diff(_, "days"), d = u.diff(_, "months"), l = u.diff(_, "years"), n = 1e3 * (a = 60 * (o = 60 * (r = 24 * h))), i.endsWith("s") || (i += "s"), Math.floor({ milliseconds: n, seconds: a, minutes: o, hours: r, days: h, months: d, years: l }[i]) }, today() { const t = this.get_date_values(new Date).slice(0, 3); return new Date(...t) }, now: () => new Date, add(t, e, s) { e = parseInt(e, 10); const i = [t.getFullYear() + ("year" === s ? e : 0), t.getMonth() + ("month" === s ? e : 0), t.getDate() + ("day" === s ? e : 0), t.getHours() + ("hour" === s ? e : 0), t.getMinutes() + ("minute" === s ? e : 0), t.getSeconds() + ("second" === s ? e : 0), t.getMilliseconds() + ("millisecond" === s ? e : 0)]; return new Date(...i) }, start_of(t, e) { const s = { year: 6, month: 5, day: 4, hour: 3, minute: 2, second: 1, millisecond: 0 }; function i(t) { const i = s[e]; return s[t] <= i } const n = [t.getFullYear(), i("year") ? 0 : t.getMonth(), i("month") ? 1 : t.getDate(), i("day") ? 0 : t.getHours(), i("hour") ? 0 : t.getMinutes(), i("minute") ? 0 : t.getSeconds(), i("second") ? 0 : t.getMilliseconds()]; return new Date(...n) }, clone(t) { return new Date(...this.get_date_values(t)) }, get_date_values: t => [t.getFullYear(), t.getMonth(), t.getDate(), t.getHours(), t.getMinutes(), t.getSeconds(), t.getMilliseconds()], get_days_in_month(t) { const e = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31], s = t.getMonth(); if (1 !== s) return e[s]; const i = t.getFullYear(); return i % 4 == 0 && i % 100 != 0 || i % 400 == 0 ? 29 : 28 } }; function r(t, e, s) { return t += "", e >>= 0, s = String(void 0 !== s ? s : " "), t.length > e ? String(t) : ((e -= t.length) > s.length && (s += s.repeat(e / s.length)), s.slice(0, e) + String(t)) } function o(t, e) { return "string" == typeof t ? (e || document).querySelector(t) : t || null } function h(t, e) { const s = document.createElementNS("http://www.w3.org/2000/svg", t); for (let t in e) if ("append_to" === t) { e.append_to.appendChild(s) } else "innerHTML" === t ? s.innerHTML = e.innerHTML : s.setAttribute(t, e[t]); return s } function d(t, e, s, i) { const n = function (t, e, s, i, n = "0.4s", a = "0.1s") { const r = t.querySelector("animate"); if (r) return o.attr(r, { attributeName: e, from: s, to: i, dur: n, begin: "click + " + a }), t; const d = h("animate", { attributeName: e, from: s, to: i, dur: n, begin: a, calcMode: "spline", values: s + ";" + i, keyTimes: "0; 1", keySplines: (l = "ease-out", { ease: ".25 .1 .25 1", linear: "0 0 1 1", "ease-in": ".42 0 1 1", "ease-out": "0 0 .58 1", "ease-in-out": ".42 0 .58 1" }[l]) }); var l; return t.appendChild(d), t }(t, e, s, i); if (n === t) { const t = document.createEvent("HTMLEvents"); t.initEvent("click", !0, !0), t.eventName = "click", n.dispatchEvent(t) } } o.on = ((t, e, s, i) => { i ? o.delegate(t, e, s, i) : (i = s, o.bind(t, e, i)) }), o.off = ((t, e, s) => { t.removeEventListener(e, s) }), o.bind = ((t, e, s) => { e.split(/\s+/).forEach(function (e) { t.addEventListener(e, s) }) }), o.delegate = ((t, e, s, i) => { t.addEventListener(e, function (t) { const e = t.target.closest(s); e && (t.delegatedTarget = e, i.call(this, t, e)) }) }), o.closest = ((t, e) => e ? e.matches(t) ? e : o.closest(t, e.parentNode) : null), o.attr = ((t, e, s) => { if (!s && "string" == typeof e) return t.getAttribute(e); if ("object" != typeof e) t.setAttribute(e, s); else for (let s in e) o.attr(t, s, e[s]) }); class l { constructor(t, e) { this.set_defaults(t, e), this.prepare(), this.draw(), this.bind() } set_defaults(t, e) { this.action_completed = !1, this.gantt = t, this.task = e } prepare() { this.prepare_values(), this.prepare_helpers() } prepare_values() { this.invalid = this.task.invalid, this.height = this.gantt.options.bar_height, this.x = this.compute_x(), this.y = this.compute_y(), this.corner_radius = this.gantt.options.bar_corner_radius, this.duration = a.diff(this.task._end, this.task._start, "hour") / this.gantt.options.step, this.width = this.gantt.options.column_width * this.duration, this.progress_width = this.gantt.options.column_width * this.duration * (this.task.progress / 100) || 0, this.group = h("g", { class: "bar-wrapper " + (this.task.custom_class || "") + (this.task.editable ? "" : " disabled"), "data-id": this.task.id, id: this.task.id }), this.inner_bar_group = h("g", { class: "bar-group-wrapper", append_to: this.group }), this.bar_group = h("g", { class: "bar-group", append_to: this.inner_bar_group }), this.handle_group = h("g", { class: "handle-group", append_to: this.inner_bar_group }), this.endpoint_group = h("g", { class: "endpoint-group", append_to: this.group }) } prepare_helpers() { SVGElement.prototype.getX = function () { return +this.getAttribute("x") }, SVGElement.prototype.getY = function () { return +this.getAttribute("y") }, SVGElement.prototype.getWidth = function () { return +this.getAttribute("width") }, SVGElement.prototype.getHeight = function () { return +this.getAttribute("height") }, SVGElement.prototype.getEndX = function () { return this.getX() + this.getWidth() } } draw() { this.draw_bar(), this.draw_progress_bar(), this.draw_label(), this.draw_resize_handles(), this.draw_endpoints() } draw_bar() { this.$bar = h("rect", { x: this.x, y: this.y, width: this.width, height: this.height, rx: this.corner_radius, ry: this.corner_radius, class: "bar", style: this.task.primary_color ? "fill:" + this.task.primary_color : "", append_to: this.bar_group }), d(this.$bar, "width", 0, this.width), this.invalid && this.$bar.classList.add("bar-invalid") } draw_progress_bar() { if (this.invalid) return; let t = this.progress_width, e = this.progress_width >= this.width ? this.width : this.progress_width; this.$bar_progress = h("rect", { x: this.x, y: this.y, width: t, height: this.height, rx: this.corner_radius, ry: this.corner_radius, class: "bar-progress", style: (this.task.secondary_color ? "fill:" + this.task.secondary_color + "; " : "") + "opacity: 0.5", append_to: this.bar_group }), this.$bar_progress_inner = h("rect", { x: this.x, y: this.y, width: e, height: this.height, rx: this.corner_radius, ry: this.corner_radius, class: "bar-progress", style: this.task.secondary_color ? "fill:" + this.task.secondary_color + "; " : "", append_to: this.bar_group }), d(this.$bar_progress_inner, "width", 0, e), d(this.$bar_progress, "width", 0, t) } draw_label() { h("text", { x: this.x + this.width / 2, y: this.y + this.height / 2, style: this.task.text_color ? "fill:" + this.task.text_color + "; " : "", innerHTML: this.task.name, class: "bar-label", append_to: this.bar_group }), requestAnimationFrame(() => this.update_label_position()) } draw_resize_handles() { if (this.invalid) return; const t = this.$bar; this.task.start_drag && h("rect", { x: t.getX() + t.getWidth() - 9, y: t.getY() + 1, width: 8, height: this.height - 2, rx: this.corner_radius, ry: this.corner_radius, class: "handle right", append_to: this.handle_group }), this.task.end_drag && h("rect", { x: t.getX() + 1, y: t.getY() + 1, width: 8, height: this.height - 2, rx: this.corner_radius, ry: this.corner_radius, class: "handle left", append_to: this.handle_group }), this.task.editable && (this.task.progress || 0 === this.task.progress) && (this.$handle_progress = h("polygon", { points: this.get_progress_polygon_points().join(","), class: "handle progress", append_to: this.handle_group })) } draw_endpoints() { if (this.invalid) return; const t = this.$bar; this.$endpoint_end = h("circle", { cx: t.getEndX() + 8, cy: t.getY() + t.getHeight() / 2, r: 4, class: "endpoint end", append_to: this.endpoint_group }), this.$endpoint_start = h("circle", { cx: t.getX() - 8, cy: t.getY() + t.getHeight() / 2, r: 4, class: "endpoint start", append_to: this.endpoint_group }) } get_progress_polygon_points() { const t = this.$bar_progress; return [t.getEndX() - 5, t.getY() + t.getHeight(), t.getEndX() + 5, t.getY() + t.getHeight(), t.getEndX(), t.getY() + t.getHeight() - 8.66] } bind() { this.invalid || this.setup_click_event() } setup_click_event() { o.on(this.inner_bar_group, "focus " + this.gantt.options.popup_trigger, t => { this.action_completed || ("click" === t.type && this.gantt.trigger_event("click", [this.task]), this.gantt.unselect_all(), this.group.classList.toggle("active"), this.show_popup()) }) } show_popup() { if (this.gantt.bar_being_dragged) return; const t = a.format(this.task._start, "", this.gantt.options.language) + " - " + a.format(a.add(this.task._end, -1, "second"), "", this.gantt.options.language); this.gantt.show_popup({ target_element: this.$bar, title: this.task.name, subtitle: t, task: this.task }) } update_bar_position({ x: t = null, width: e = null }) { const s = this.$bar; if (t) { if (!this.task.dependencies.map(t => this.gantt.get_bar(t).$bar.getX()).reduce((e, s) => t >= s, t)) return void (e = null); this.update_attr(s, "x", t) } e && e >= this.gantt.options.column_width && this.update_attr(s, "width", e), this.update_label_position(), this.update_handle_position(); let i = this.$bar.getWidth() * (this.task.progress / 100); this.update_progressbar_position(this.$bar_progress, i), this.update_progressbar_position(this.$bar_progress_inner, i > this.$bar.getWidth() ? this.$bar.getWidth() : i), this.update_arrow_position(), this.update_endpoints_position() } date_changed() { if (!this.task.editable) return; let t = !1; const { new_start_date: e, new_end_date: s } = this.compute_start_end_date(); Number(this.task._start) !== Number(e) && (t = !0, this.task._start = e), Number(this.task._end) !== Number(s) && (t = !0, this.task._end = s), t && this.gantt.trigger_event("date_change", [this.task, e, a.add(s, -1, "second")]) } progress_changed() { if (!this.task.editable) return; const t = this.compute_progress(); this.task.progress = t, this.gantt.trigger_event("progress_change", [this.task, t]) } set_action_completed() { this.action_completed = !0, this.timer || (this.timer = setTimeout(() => { this.action_completed = !1, this.timer = void 0 }, 1e3)) } compute_start_end_date() { const t = this.$bar, e = t.getX() / this.gantt.options.column_width, s = a.add(this.gantt.gantt_start, e * this.gantt.options.step, "hour"), i = t.getWidth() / this.gantt.options.column_width; return { new_start_date: s, new_end_date: a.add(s, i * this.gantt.options.step, "hour") } } compute_progress() { const t = this.$bar_progress.getWidth() / this.$bar.getWidth() * 100; return parseInt(t, 10) } compute_x() { const { step: t, column_width: e } = this.gantt.options, s = this.task._start, i = this.gantt.gantt_start; let n = a.diff(s, i, "hour") / t * e; if (this.gantt.view_is("Month")) { n = a.diff(s, i, "day") * e / 30 } return n } compute_y() { return this.gantt.options.header_height + this.gantt.options.padding + this.task._index * (this.height + this.gantt.options.padding) } get_snap_position(t) { let e, s, i = t; return s = this.gantt.view_is("Week") ? i - (e = t % (this.gantt.options.column_width / 7)) + (e < this.gantt.options.column_width / 14 ? 0 : this.gantt.options.column_width / 7) : this.gantt.view_is("Month") ? i - (e = t % (this.gantt.options.column_width / 30)) + (e < this.gantt.options.column_width / 60 ? 0 : this.gantt.options.column_width / 30) : i - (e = t % this.gantt.options.column_width) + (e < this.gantt.options.column_width / 2 ? 0 : this.gantt.options.column_width) } update_attr(t, e, s) { return s = +s, isNaN(s) || t.setAttribute(e, s), t } update_progressbar_position(t, e) { t.setAttribute("x", this.$bar.getX()), t.setAttribute("width", e) } update_label_position() { const t = this.$bar, e = this.group.querySelector(".bar-label"); e.getBBox().width > t.getWidth() ? (e.classList.add("big"), e.setAttribute("x", t.getX() + t.getWidth() + 15)) : (e.classList.remove("big"), e.setAttribute("x", t.getX() + t.getWidth() / 2)) } update_handle_position() { const t = this.$bar, e = this.handle_group.querySelector(".handle.left"); e && e.setAttribute("x", t.getX() + 1); const s = this.handle_group.querySelector(".handle.right"); s && s.setAttribute("x", t.getEndX() - 9); const i = this.group.querySelector(".handle.progress"); i && i.setAttribute("points", this.get_progress_polygon_points()) } update_arrow_position() { this.arrows = this.arrows || []; for (let t of this.arrows) t.update() } update_endpoints_position() { const t = this.$bar, e = this.endpoint_group.querySelector(".endpoint.start"); e && e.setAttribute("cx", t.getX() - 8); const s = this.endpoint_group.querySelector(".endpoint.end"); s && s.setAttribute("cx", t.getEndX() + 8) } } class u { constructor(t, e, s) { this.gantt = t, this.from_task = e, this.to_task = s, this.calculate_path(), this.draw() } calculate_path() { this.endpoint || (this.endpoint = this.from_task.$bar.getX() <= this.to_task.$bar.getX() ? this.from_task.$endpoint_end : this.from_task.$endpoint_start, this.endpoint.style.opacity = 1, this.endpoint.is_used = !0); const t = this.endpoint.getAttribute("cx"), e = this.endpoint.getAttribute("cy"), s = this.to_task.$bar.getX() - this.gantt.options.padding / 2, i = this.gantt.options.header_height + this.gantt.options.bar_height / 2 + (this.gantt.options.padding + this.gantt.options.bar_height) * this.to_task.task._index + this.gantt.options.padding, n = this.from_task.task._index >= this.to_task.task._index, a = this.gantt.options.arrow_curve, r = n ? 1 : 0, o = n ? -a : a, h = (n ? this.gantt.options.arrow_curve : this.gantt.options.arrow_curve, this.gantt.options.padding - a), d = this.to_task.$bar.getY() + this.to_task.$bar.getHeight() / 2 - o, l = this.to_task.$bar.getX() - this.gantt.options.padding; if (this.endpoint.getAttribute("class").includes("start")) { let n = this.to_task.$endpoint_start.getAttribute("cx") > this.from_task.$endpoint_end.getAttribute("cx") ? `h ${2 * -a}` : `H ${l}`; this.path = `\n            M ${t} ${e}\n            ${n}\n            a ${a} ${a} 0 0 ${r} -${a} ${o}\n            V ${d}\n            a ${a} ${a} 0 0 ${r} ${a} ${o}\n            L ${s} ${i}\n            m -5 -5\n            l 5 5\n            l -5 5` } else this.to_task.$endpoint_start.getAttribute("cx") <= this.from_task.$endpoint_end.getAttribute("cx") ? this.path = `\n                M ${t} ${e}\n                v ${h}\n                a ${a} ${a} 0 0 1 -${a} ${a}\n                H ${l}\n                a ${a} ${a} 0 0 ${r} -${a} ${o}\n                V ${d}\n                a ${a} ${a} 0 0 ${r} ${a} ${o}\n                L ${s} ${i}\n                m -5 -5\n                l 5 5\n                l -5 5` : this.to_task.$bar.getY() !== this.from_task.$bar.getY() ? this.path = `\n                    M ${t} ${e}\n                    V ${d}\n                    a ${a} ${a} 0 0 ${r} ${a} ${o}\n                    L ${s} ${i}\n                    m -5 -5\n                    l 5 5\n                    l -5 5` : this.path = `\n                    M ${t} ${e}\n                    L ${s} ${i}\n                    m -5 -5\n                    l 5 5\n                    l -5 5` } setup_click_event() { this.from_task.task.editable && this.to_task.task.editable && o.on(this.element, "click", t => { "click" === t.type && this.gantt.trigger_event("dependency_deleted", [{ from: this.from_task.task.id, to: this.to_task.task.id }]), this.element.parentNode.removeChild(this.element), 0 === this.to_task.task.dependencies.length && (this.element.style.opacity = null), this.to_task.task.dependencies = this.to_task.task.dependencies.filter(t => t !== this.from_task.task.id), this.gantt.arrows = this.gantt.arrows.filter(t => t !== this), this.from_task.arrows = this.from_task.arrows.filter(t => t !== this); let e = !1; this.from_task.arrows.forEach(t => { t.endpoint === this.endpoint && (e = !0) }), this.endpoint.is_used = e, this.endpoint.style.opacity = e ? 1 : null, this.to_task.arrows = this.to_task.arrows.filter(t => t !== this) }) } draw() { this.element = h("path", { d: this.path, "data-from": this.from_task.task.id, "data-to": this.to_task.task.id }), this.setup_click_event() } update() { this.calculate_path(), this.element.setAttribute("d", this.path) } } class _ { constructor(t, e) { this.parent = t, this.custom_html = e, this.make() } make() { this.parent.innerHTML = '\n            <div class="title"></div>\n            <div class="subtitle"></div>\n            <div class="pointer"></div>\n        ', this.hide(), this.title = this.parent.querySelector(".title"), this.subtitle = this.parent.querySelector(".subtitle"), this.pointer = this.parent.querySelector(".pointer") } show(t) { if (!t.target_element) throw new Error("target_element is required to show popup"); t.position || (t.position = "left"), this.options = t; const e = t.target_element; if (this.custom_html) { let e = this.custom_html(t.task); e += '<div class="pointer"></div>', this.parent.innerHTML = e, this.pointer = this.parent.querySelector(".pointer") } else if ("string" == typeof t.task.to_show_in_popup) { this.parent.innerHTML = '<div class="title">' + t.title + "</div>", t.task.to_show_in_popup.split(",").forEach(e => { let s = e.split(":"); this.parent.innerHTML += '\n                    <div class="' + (0 === s[0].length ? "subtitle" : s[0]) + '">' + (0 === s[1].length ? "" : s[1] + ": ") + t.task[s[2]] + "</div>" }), this.parent.innerHTML += '<div class="pointer"></div>', this.pointer = this.parent.querySelector(".pointer") } else this.make(), this.title.innerHTML = t.title, this.subtitle.innerHTML = t.subtitle, this.parent.style.width = this.parent.clientWidth + "px"; let s; e instanceof HTMLElement ? s = e.getBoundingClientRect() : e instanceof SVGElement && (s = t.target_element.getBBox()), "left" === t.position && (this.parent.style.left = s.x + (s.width + 10) + "px", this.parent.style.top = s.y + "px", this.pointer.style.transform = "rotateZ(90deg)", this.pointer.style.left = "-7px", this.pointer.style.top = "2px"), this.parent.style.visibility = "visible" } hide() { this.parent.style.visibility = "hidden" } } class c { constructor(t, e) { this.gantt = t, this.parent = t.$svg_swimlanes, this.swimlane = e, this.set_defaults(), this.make() } set_defaults() { this.longest_title_width = this.parent.longest_title_width, this.longest_sub_title_width = this.parent.longest_sub_title_width, this.container_width = this.parent.getBoundingClientRect().width, this.padding = this.gantt.options.padding, this.swimlanes_map = this.gantt.swimlanes_map, this.row_height = this.gantt.row_height, this.header_height = this.gantt.header.getBoundingClientRect().height } make() { this.make_main_cell(), this.make_sub_cells() } make_main_cell() { this.swimlane_group = h("g", { class: "swimlane", id: this.swimlane, append_to: this.parent }), this.title = h("text", { x: this.padding, y: 0, innerHTML: this.swimlane, class: "swimlane-label", append_to: this.swimlane_group }), this.main_cell = h("rect", { x: 0, y: 0, width: this.container_width, height: 0, class: "swimlane-row", append_to: this.swimlane_group }), this.swimlane_group.appendChild(this.title) } make_sub_cells() { this.from_row = Number.MAX_SAFE_INTEGER, this.to_row = 0; for (let t in this.swimlanes_map[this.swimlane]) { let e = this.swimlanes_map[this.swimlane][t]; if (this.from_row = e < this.from_row ? e : this.from_row, this.to_row = e > this.to_row ? e : this.to_row, !t.includes("undefined")) { let s = h("g", { class: "sub-swimlane", id: t, append_to: this.swimlane_group }), i = this.gantt.get_y_coord_of_row(e), n = h("text", { x: 0, y: (0 === e ? this.header_height : i) + 3 * this.row_height / 5, innerHTML: t, class: "sub-swimlane-label", append_to: s }), a = this.container_width - this.longest_sub_title_width - this.padding; h("rect", { x: a, y: 0 === e ? this.header_height : i, width: this.longest_sub_title_width + this.padding, height: this.row_height, class: "sub-swimlane-row", append_to: s }), o.attr(n, "x", a + this.padding / 2), s.appendChild(n) } } this.update_main_cell_position() } update_main_cell_position() { let t = this.gantt.get_y_coord_of_row(this.from_row); o.attr(this.title, "y", (0 === this.from_row ? this.header_height : t) + this.row_height * (this.to_row - this.from_row + 1) / 2 + this.title.getBoundingClientRect().height / 4), o.attr(this.main_cell, "y", 0 === this.from_row ? this.header_height : t), o.attr(this.main_cell, "height", this.row_height * Math.abs(this.to_row - this.from_row + 1)) } static get_longest_title_width(t, e) { let s, i = 0; t.tasks.forEach(t => { e && t.swimlane && t.swimlane.length > i && (i = t.swimlane.length, s = t.swimlane), !e && t.sub_swimlane && t.sub_swimlane.length > i && (i = t.sub_swimlane.length, s = t.sub_swimlane) }); let n = h("g", { class: "swimlane", append_to: t.$svg_swimlanes }), a = h("text", { x: t.options.padding, y: 0, innerHTML: s, class: "swimlane-label", append_to: n }).getBBox().width; return t.$svg_swimlanes.innerHTML = "", a } } return class { constructor(t, e, s) { this.setup_wrapper(t), this.setup_options(s), this.setup_swimlanes(e), this.setup_tasks(e), this.change_view_mode(), this.bind_events() } setup_wrapper(t) { let e, s; if ("string" == typeof t && (t = document.querySelector(t)), t instanceof HTMLElement) s = t, e = t.querySelector("svg"); else { if (!(t instanceof SVGElement)) throw new TypeError("Frappé Gantt only supports usage of a string CSS selector, HTML DOM element or SVG DOM element for the 'element' parameter"); e = t } e ? (this.$svg = e, this.$svg.classList.add("gantt")) : this.$svg = h("svg", { append_to: s, class: "gantt" }), this.$swimlanes_container = document.createElement("div"), this.$swimlanes_container.classList.add("gantt-swimlanes-container"), this.$container = document.createElement("div"), this.$container.classList.add("gantt-container"); const i = this.$svg.parentElement; i.appendChild(this.$swimlanes_container), i.appendChild(this.$container), this.$container.appendChild(this.$svg), this.$svg_swimlanes = h("svg", { append_to: this.$swimlanes_container, class: "gantt-swimlanes" }), this.$swimlanes_container.appendChild(this.$svg_swimlanes), this.popup_wrapper = document.createElement("div"), this.popup_wrapper.classList.add("popup-wrapper"), this.$container.appendChild(this.popup_wrapper) } setup_options(t) { this.options = Object.assign({}, { header_height: 50, column_width: 30, step: 24, view_modes: ["Quarter Day", "Half Day", "Day", "Week", "Month", "Year"], bar_height: 20, bar_corner_radius: 3, arrow_curve: 5, padding: 18, view_mode: "Day", date_format: "YYYY-MM-DD", popup_trigger: "click", custom_popup_html: null, language: "en" }, t) } setup_defaults() { this.row_height = this.options.bar_height + this.options.padding, this.row_width = this.dates.length * this.options.column_width, this.table_height = this.options.header_height + this.options.padding / 2 + this.row_height * (0 === this.tasks.length ? 5 : this.indexed_tasks.length + 1), this.table_width = this.dates.length * this.options.column_width, this.popups_bar = null, this.popup && (this.popup.parent.style.visibility = "hidden") } setup_tasks(t) { this.indexed_tasks = [], this.tasks = t.map((t, e) => { if (t._start = a.parse(t.start), t._end = a.parse(t.end), a.diff(t._end, t._start, "year") > 10 && (t.end = null), t._index = t.swimlane ? t.sub_swimlane ? this.swimlanes_map[t.swimlane][t.sub_swimlane] : this.swimlanes_map[t.swimlane]["undefined" + t.id] : this.swimlanes_map[t.id], this.indexed_tasks.includes(t._index) || this.indexed_tasks.push(t._index), !t.start && !t.end) { const e = a.today(); t._start = e, t._end = a.add(e, 2, "day") } if (!t.start && t.end && (t._start = a.add(t._end, -2, "day")), t.start && !t.end && (t._end = a.add(t._start, 2, "day")), a.get_date_values(t._end).slice(3).every(t => 0 === t) && (t._end = a.add(t._end, 24, "hour")), t.start && t.end || (t.invalid = !0), "string" == typeof t.dependencies || !t.dependencies) { let e = []; t.dependencies && (e = t.dependencies.split(",").map(t => t.trim()).filter(t => t)), t.dependencies = e } return t.id || (t.id = t.name + "_" + Math.random().toString(36).slice(2, 12)), t }), this.remove_empty_rows(), this.setup_dependencies() } setup_dependencies() { this.dependency_map = {}; for (let t of this.tasks) for (let e of t.dependencies) this.dependency_map[e] = this.dependency_map[e] || [], this.dependency_map[e].push(t.id) } remove_empty_rows() { let t = [...Array(this.tasks.length).keys()]; (t = t.filter(t => !this.indexed_tasks.includes(t))).forEach(t => { for (var e in this.tasks.forEach(e => { e._index > t && (e._index -= 1) }), this.swimlanes_map) for (var s in this.swimlanes_map[e]) this.swimlanes_map[e][s] > t && (this.swimlanes_map[e][s] -= 1) }) } setup_swimlanes(t) { t.map(t => t.used = !1), this.contains_swimlanes = !1, this.swimlanes_map = {}; let e = 0; t.map(s => { s.swimlane && !0 !== s.used && (this.contains_swimlanes = !0, t.map(t => { s.swimlane === t.swimlane && (this.swimlanes_map[t.swimlane] = this.swimlanes_map[t.swimlane] || {}, isNaN(this.swimlanes_map[t.swimlane][t.sub_swimlane]) && (t.sub_swimlane ? this.swimlanes_map[t.swimlane][t.sub_swimlane] = e : this.swimlanes_map[t.swimlane]["undefined" + t.id] = e, e += 1, t.used = !0)) })) }), t.map(t => { if (!t.swimlane) { let s = new String(t.id); s.invalid = !0, this.swimlanes_map[s] = {}, this.swimlanes_map[s] = e, e += 1 } }) } refresh(t) { this.setup_swimlanes(t), this.setup_tasks(t), this.change_view_mode() } change_view_mode(t = this.options.view_mode) { this.update_view_scale(t), this.setup_dates(), this.setup_defaults(), this.render(), this.trigger_event("view_change", [t]) } update_view_scale(t) { this.options.view_mode = t, "Day" === t ? (this.options.step = 24, this.options.column_width = 38) : "Half Day" === t ? (this.options.step = 12, this.options.column_width = 38) : "Quarter Day" === t ? (this.options.step = 6, this.options.column_width = 38) : "Week" === t ? (this.options.step = 168, this.options.column_width = 140) : "Month" === t ? (this.options.step = 720, this.options.column_width = 120) : "Year" === t && (this.options.step = 8760, this.options.column_width = 120) } setup_dates() { this.setup_gantt_dates(), this.setup_date_values() } setup_gantt_dates() { this.gantt_start = this.gantt_end = null; for (let t of this.tasks) (!this.gantt_start || t._start < this.gantt_start) && (this.gantt_start = t._start), (!this.gantt_end || t._end > this.gantt_end) && (this.gantt_end = t._end); 0 === this.tasks.length ? (this.gantt_start = a.now(), this.gantt_end = a.add(this.gantt_start, 1, "year")) : (this.gantt_start = a.start_of(this.gantt_start, "day"), this.gantt_end = a.start_of(this.gantt_end, "day")), this.view_is(["Quarter Day", "Half Day"]) ? (this.gantt_start = a.add(this.gantt_start, -7, "day"), this.gantt_end = a.add(this.gantt_end, 7, "day")) : this.view_is("Month") ? (this.gantt_start = a.add(this.gantt_start, -1, "year"), this.gantt_end = a.add(this.gantt_end, 1, "year")) : this.view_is("Year") ? (this.gantt_start = a.add(this.gantt_start, -2, "year"), this.gantt_end = a.add(this.gantt_end, 2, "year")) : (this.gantt_start = a.add(this.gantt_start, -1, "month"), this.gantt_end = a.add(this.gantt_end, 1, "month")) } setup_date_values() { this.dates = []; let t = null; for (; null === t || t < this.gantt_end;)t = t ? this.view_is("Year") ? a.add(t, 1, "year") : this.view_is("Month") ? a.add(t, 1, "month") : a.add(t, this.options.step, "hour") : a.clone(this.gantt_start), this.dates.push(t) } bind_events() { this.bind_grid_click(), this.bind_bar_events() } render() { this.clear(), this.setup_layers(), this.make_grid(), this.make_dates(), this.make_bars(), this.make_arrows(), this.map_arrows_on_bars(), this.set_width(), this.set_scroll_position(), this.make_swimlanes(), this.reload_popup() } setup_layers() { this.layers = {}; const t = ["grid", "date", "bar", "progress", "arrow", "details"]; for (let e of t) this.layers[e] = h("g", { class: e, append_to: this.$svg }) } make_grid() { this.make_grid_background(), this.make_grid_rows(), this.make_grid_header(), this.make_grid_ticks(), this.make_grid_highlights() } make_grid_background() { const t = this.table_width, e = this.table_height; h("rect", { x: 0, y: 0, width: t, height: e, class: "grid-background", append_to: this.layers.grid }), o.attr(this.$svg, { height: e + this.options.padding + 100, width: "100%" }) } make_grid_rows() { const t = h("g", { append_to: this.layers.grid }), e = h("g", { append_to: this.layers.grid }), s = this.row_width, i = this.row_height; let n = this.options.header_height + this.options.padding / 2; for (let a = 0; a <= (0 === this.tasks.length ? 5 : this.indexed_tasks.length); a++)h("rect", { x: 0, y: n, width: s, height: i, class: "grid-row", append_to: t }), h("line", { x1: 0, y1: n + i, x2: s, y2: n + i, class: "row-line", append_to: e }), n += this.options.bar_height + this.options.padding } make_grid_header() { const t = this.row_width, e = this.options.header_height + 10; this.header = h("rect", { x: 0, y: 0, width: t, height: e, class: "grid-header", append_to: this.layers.grid }) } make_grid_ticks() { let t = 0, e = this.options.header_height + this.options.padding / 2, s = this.row_height * this.indexed_tasks.length; for (let i of this.dates) { let n = "tick"; this.view_is("Day") && 1 === i.getDate() && (n += " thick"), this.view_is("Week") && i.getDate() >= 1 && i.getDate() < 8 && (n += " thick"), this.view_is("Month") && (i.getMonth() + 1) % 3 == 0 && (n += " thick"), h("path", { d: `M ${t} ${e} v ${s}`, class: n, append_to: this.layers.grid }), this.view_is("Month") ? t += a.get_days_in_month(i) * this.options.column_width / 30 : t += this.options.column_width } } make_grid_highlights() { this.view_is("Day") && h("rect", { x: a.diff(a.today(), this.gantt_start, "hour") / this.options.step * this.options.column_width, y: 0, width: this.options.column_width, height: this.row_height * this.indexed_tasks.length + this.options.header_height + this.options.padding / 2, class: "today-highlight", append_to: this.layers.grid }) } make_dates() { for (let t of this.get_dates_to_draw()) if (h("text", { x: t.lower_x, y: t.lower_y, innerHTML: t.lower_text, class: "lower-text", append_to: this.layers.date }), t.upper_text) { const e = h("text", { x: t.upper_x, y: t.upper_y, innerHTML: t.upper_text, class: "upper-text", append_to: this.layers.date }); e.getBBox().x2 > this.layers.grid.getBBox().width && e.remove() } } get_dates_to_draw() { let t = null; return this.dates.map((e, s) => { const i = this.get_date_info(e, t, s); return t = e, i }) } get_date_info(t, e, s) { e || (e = a.add(t, 1, "year")); const i = { "Quarter Day_lower": a.format(t, "HH", this.options.language), "Half Day_lower": a.format(t, "HH", this.options.language), Day_lower: t.getDate() !== e.getDate() ? a.format(t, "D", this.options.language) : "", Week_lower: t.getMonth() !== e.getMonth() ? a.format(t, "D MMM", this.options.language) : a.format(t, "D", this.options.language), Month_lower: a.format(t, "MMMM", this.options.language), Year_lower: a.format(t, "YYYY", this.options.language), "Quarter Day_upper": t.getDate() !== e.getDate() ? a.format(t, "D MMM", this.options.language) : "", "Half Day_upper": t.getDate() !== e.getDate() ? t.getMonth() !== e.getMonth() ? a.format(t, "D MMM", this.options.language) : a.format(t, "D", this.options.language) : "", Day_upper: t.getMonth() !== e.getMonth() ? a.format(t, "MMMM", this.options.language) : "", Week_upper: t.getMonth() !== e.getMonth() ? a.format(t, "MMMM", this.options.language) : "", Month_upper: t.getFullYear() !== e.getFullYear() ? a.format(t, "YYYY", this.options.language) : "", Year_upper: t.getFullYear() !== e.getFullYear() ? a.format(t, "YYYY", this.options.language) : "" }, n = { x: s * this.options.column_width, lower_y: this.options.header_height, upper_y: this.options.header_height - 25 }, r = { "Quarter Day_lower": 4 * this.options.column_width / 2, "Quarter Day_upper": 0, "Half Day_lower": 2 * this.options.column_width / 2, "Half Day_upper": 0, Day_lower: this.options.column_width / 2, Day_upper: 30 * this.options.column_width / 2, Week_lower: 0, Week_upper: 4 * this.options.column_width / 2, Month_lower: this.options.column_width / 2, Month_upper: 12 * this.options.column_width / 2, Year_lower: this.options.column_width / 2, Year_upper: 30 * this.options.column_width / 2 }; return { upper_text: i[`${this.options.view_mode}_upper`], lower_text: i[`${this.options.view_mode}_lower`], upper_x: n.x + r[`${this.options.view_mode}_upper`], upper_y: n.upper_y, lower_x: n.x + r[`${this.options.view_mode}_lower`], lower_y: n.lower_y } } make_swimlanes() { if (0 === this.tasks.length || !this.contains_swimlanes) return void o.attr(this.$svg_swimlanes, "display", "none"); o.attr(this.$svg_swimlanes, "display", "visible"), this.$svg_swimlanes.longest_title_width = c.get_longest_title_width(this, !0), this.$svg_swimlanes.longest_sub_title_width = c.get_longest_title_width(this, !1); const t = this.$svg_swimlanes.longest_title_width + this.$svg_swimlanes.longest_sub_title_width + 3 * this.options.padding; for (var e in o.attr(this.$svg_swimlanes, "height", this.table_height + 1), o.attr(this.$svg_swimlanes, "width", t), h("rect", { x: 0, y: this.header.getBoundingClientRect().height, width: t, height: this.table_height - this.header.getBoundingClientRect().height, class: "swimlanes-background", append_to: this.$svg_swimlanes }), h("rect", { x: 0, y: 0, width: t, height: this.header.getBoundingClientRect().height, class: "swimlanes-header", append_to: this.$svg_swimlanes }), this.swimlanes_map) e.invalid || new c(this, e); h("line", { x1: 0, y1: this.get_y_coord_of_row(this.indexed_tasks[this.indexed_tasks.length - 1]) + this.row_height, x2: this.row_width, y2: this.get_y_coord_of_row(this.indexed_tasks[this.indexed_tasks.length - 1]) + this.row_height, class: "separator", append_to: this.$svg_swimlanes }), h("line", { x1: t, y1: 0, x2: t, y2: this.table_height, class: "separator", append_to: this.$svg_swimlanes }) } make_bars() { this.bars = this.tasks.map(t => { const e = new l(this, t); return this.popup && t.id === this.popup.options.task.id && (this.popups_bar = e), this.layers.bar.appendChild(e.group), e }) } reload_popup() { this.popups_bar && this.popups_bar.show_popup() } make_arrows() { this.arrows = []; for (let t of this.tasks) { let e = []; e = t.dependencies.map(e => { const s = this.get_task(e); if (!s) return; const i = new u(this, this.get_bar(s.id), this.get_bar(t.id)); return this.layers.arrow.appendChild(i.element), i }).filter(Boolean), this.arrows = this.arrows.concat(e) } } map_arrows_on_bars() { for (let t of this.bars) t.arrows = this.arrows.filter(e => e.from_task.task.id === t.task.id || e.to_task.task.id === t.task.id) } set_width() { const t = this.$svg.getBoundingClientRect().width, e = this.$svg.querySelector(".grid .grid-row").getAttribute("width"); t < e && this.$svg.setAttribute("width", e) } set_scroll_position() { const t = this.$svg.parentElement; if (!t) return; const e = 0 === this.tasks.length ? a.diff(a.add(this.gantt_start, 30, "day"), this.gantt_start, "hour") : a.diff(this.get_oldest_starting_date(), this.gantt_start, "hour"); let s = this.view_is("Day") ? 8 : this.view_is("Month") ? 4 : 6; const i = e / this.options.step * this.options.column_width - this.options.column_width * s; t.scrollLeft = i } bind_grid_click() { o.on(this.$svg, this.options.popup_trigger, ".grid-row, .grid-header", () => { this.unselect_all(), this.hide_popup() }) } bind_bar_events() { let t = !1, e = 0, s = 0, i = !1, n = !1, a = null, r = []; this.bar_being_dragged = null, o.on(this.$svg, "mousedown", ".bar-wrapper, .handle", (h, d) => { const l = o.closest(".bar-wrapper", d); d.classList.contains("left") ? i = !0 : d.classList.contains("right") ? n = !0 : d.classList.contains("bar-wrapper") && (t = !0), l.classList.add("active"), e = h.offsetX, s = h.offsetY; const u = [a = l.getAttribute("data-id"), ...this.get_all_dependent_tasks(a)]; r = u.map(t => this.get_bar(t)), this.bar_being_dragged = a, r.forEach(t => { if (t.task.editable) { const e = t.$bar; e.ox = e.getX(), e.oy = e.getY(), e.owidth = e.getWidth(), e.finaldx = 0 } }) }), o.on(this.$svg, "mousemove", s => { if (!(t || i || n)) return; const o = s.offsetX - e; s.offsetY, r.forEach(e => { const s = e.$bar; s.finaldx = this.get_snap_position(o); let r = void 0 === e.task.start_drag || e.task.start_drag, h = void 0 === e.task.end_drag || e.task.end_drag; if (i) a === e.task.id ? (r && h || !h && s.ox + s.finaldx < s.ox + s.owidth) && e.update_bar_position({ x: s.ox + s.finaldx, width: s.owidth - s.finaldx }) : r && h && e.update_bar_position({ x: s.ox + s.finaldx }); else if (n) { if (a === e.task.id && h && s.owidth + s.finaldx > 0) { e.update_bar_position({ width: s.owidth + s.finaldx }); let t = s.getBBox(); t = t.x + (t.width + 10) + "px", this.popup_wrapper.style.left = t } } else t && r && h && e.update_bar_position({ x: s.ox + s.finaldx }) }) }), document.addEventListener("mouseup", e => { (t || i || n) && r.forEach(t => t.group.classList.remove("active")), t = !1, i = !1, n = !1 }), o.on(this.$svg, "mouseup", t => { this.bar_being_dragged = null, r.forEach(t => { t.$bar.finaldx && (t.date_changed(), t.set_action_completed()) }) }), this.bind_bar_progress(), this.bind_endpoints() } bind_bar_progress() { let t = 0, e = 0, s = null, i = null, n = null, a = null, r = null; o.on(this.$svg, "mousedown", ".handle.progress", (h, d) => { s = !0, t = h.offsetX, e = h.offsetY; const l = o.closest(".bar-wrapper", d).getAttribute("data-id"); i = this.get_bar(l), n = i.$bar_progress, a = i.$bar_progress_inner, r = i.$bar, n.finaldx = 0, n.owidth = n.getWidth(), n.min_dx = -n.getWidth() }), o.on(this.$svg, "mousemove", e => { if (!s) return; let h = e.offsetX - t; e.offsetY, h < n.min_dx && (h = n.min_dx); const d = i.$handle_progress, l = n.owidth + h; o.attr(n, "width", l), l <= r.getWidth() ? o.attr(a, "width", l) : o.attr(a, "width", r.getWidth()), o.attr(d, "points", i.get_progress_polygon_points()), n.finaldx = h }), o.on(this.$svg, "mouseup", () => { if (s) { if (s = !1, !n || !n.finaldx) return; i.progress_changed(), i.set_action_completed() } }) } bind_endpoints() { let t = null, e = null; o.on(this.$svg, "click", ".endpoint", (s, i) => { const n = o.closest(".bar-wrapper", i); if (!i.classList.contains("start")) if (null == t) (t = this.get_bar(n.getAttribute("data-id"))) && t.task.editable && this.bars.forEach(e => { t == e || e.task.dependencies.includes(t.task.id) || e.task && e.task.editable && e.$endpoint_end.classList.add("endpoint-active") }); else { if (e = this.get_bar(n.getAttribute("data-id")), t !== e && e.$endpoint_end.classList.contains("endpoint-active")) { e.task.dependencies.push(t.task.id); const s = new u(this, t, e); this.layers.arrow.appendChild(s.element), this.arrows.push(s), t.arrows.push(s), e.arrows.push(s), this.trigger_event("dependency_added", [{ from: t.task.id, to: e.task.id }]) } [t, e] = this.reset_endpoints() } }), o.on(this.$svg, "click", ".grid-row, .grid-header, .bar-group, .handle-group", () => { [t, e] = this.reset_endpoints() }) } reset_endpoints() { return this.bars.forEach(t => { t.$endpoint_end.classList.remove("endpoint-active"), t.$endpoint_end.is_used || (t.$endpoint_end.style.opacity = null), t.$endpoint_end.style.visibility = null }), [null, null] } get_all_dependent_tasks(t) { let e = [], s = [t]; for (; s.length;) { const t = s.reduce((t, e) => t = t.concat(this.dependency_map[e]), []); e = e.concat(t), s = t.filter(t => !s.includes(t)) } return e.filter(Boolean) } get_snap_position(t) { let e, s, i = t; return s = this.view_is("Week") ? i - (e = t % (this.options.column_width / 7)) + (e < this.options.column_width / 14 ? 0 : this.options.column_width / 7) : this.view_is("Month") ? i - (e = t % (this.options.column_width / 30)) + (e < this.options.column_width / 60 ? 0 : this.options.column_width / 30) : i - (e = t % this.options.column_width) + (e < this.options.column_width / 2 ? 0 : this.options.column_width) } unselect_all() { [...this.$svg.querySelectorAll(".bar-wrapper")].forEach(t => { t.classList.remove("active") }) } view_is(t) { return "string" == typeof t ? this.options.view_mode === t : !!Array.isArray(t) && t.some(t => this.options.view_mode === t) } get_task(t) { return this.tasks.find(e => e.id === t) } get_bar(t) { return this.bars.find(e => e.task.id === t) } get_y_coord_of_row(t) { return this.options.header_height + this.options.padding / 2 + this.row_height * t } show_popup(t) { this.popup || (this.popup = new _(this.popup_wrapper, this.options.custom_popup_html)), this.popup.show(t) } hide_popup() { this.popup && this.popup.hide() } trigger_event(t, e) { this.options["on_" + t] && this.options["on_" + t].apply(null, e) } get_oldest_starting_date() { return this.tasks.map(t => t._start).reduce((t, e) => e <= t ? e : t) } clear() { this.$svg.innerHTML = "", this.$svg_swimlanes.innerHTML = "" } } }();
